% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Caderno\_Inferencia\_Estatistica},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Caderno\_Inferencia\_Estatistica}
\author{}
\date{\vspace{-2.5em}2024-04-06}

\begin{document}
\maketitle

\hypertarget{sumario}{%
\section{Sumario}\label{sumario}}

\hypertarget{aula}{%
\section{Aula}\label{aula}}

\hypertarget{subtitulo}{%
\subsection{Subtitulo}\label{subtitulo}}

\hypertarget{silde}{%
\subsubsection{Silde}\label{silde}}

\hypertarget{instrumentauxe7uxe3o-matemuxe1tica-para-estatuxedstica-prof-wagner-hugo-bonat-09032024}{%
\section{Instrumentação Matemática para Estatística -- Prof Wagner Hugo
Bonat --
09/03/2024}\label{instrumentauxe7uxe3o-matemuxe1tica-para-estatuxedstica-prof-wagner-hugo-bonat-09032024}}

\begin{itemize}
\tightlist
\item
  Matemática (5 partes)
\item
  Probabilidade (1 parte)
\item
  Inferência (3 partes)
\end{itemize}

\hypertarget{tuxf3picos-em-matemuxe1tica-customizados-para-ds}{%
\subsubsection{Tópicos em matemática customizados para
DS:}\label{tuxf3picos-em-matemuxe1tica-customizados-para-ds}}

\begin{itemize}
\tightlist
\item
  Fornecer base matemática para entender e criar técnicas de análise de
  dados
\item
  Visão geral e intuitiva
\item
  Focar nos resultados e suas aplicações
\item
  Não ser exaustivo em cada tópico ou matematicamente (muito) rigoroso
\item
  Suporte computacional para compreender conceitos matemáticos abstratos
\item
  Formar uma base sólida para entender técnicas avançadas:
\item
  Modelagem estatística
\item
  Machine learnig
\end{itemize}

\hypertarget{o-curso-nuxe3o-uxe9-de-receitas-uxe9-de-fundamentos}{%
\subsubsection{O curso não é de receitas, é de
fundamentos}\label{o-curso-nuxe3o-uxe9-de-receitas-uxe9-de-fundamentos}}

\begin{itemize}
\tightlist
\item
  Os objetivos desta abordagem são:

  \begin{itemize}
  \tightlist
  \item
    Desmestificar o processo peos quais os algoritmos resolvem problemas
  \item
    Mostrar que apesar de existir um conjunto enrme de técnicas, muitas
    delas são pequenas melhorias em técnicas já existentes
  \end{itemize}
\item
  Promover um uso qualificado das ferramentas já disponíveis
\end{itemize}

\hypertarget{referencias}{%
\subsection{Referencias:}\label{referencias}}

\begin{itemize}
\tightlist
\item
  Deep Learning, Ian Goodfellow and Yoshua Bengio and Aaro Courville,
  MIT Press, 2016.
\item
  Mathematics for Machine Learning, Marc Peter Deisenroth, A. Aldo
  Faisal and Cheng Soon Ong, Cambridge, 2019
\item
  Livro do prof: Matemática para Ciências de Dados
\end{itemize}

\hypertarget{o-que-precisamos-saber}{%
\subsection{O que precisamos saber?}\label{o-que-precisamos-saber}}

\begin{itemize}
\tightlist
\item
  Cálculo Diferencial e Integral
\item
  Funções, limites e continuidade
\item
  Derivadas
\item
  Integrais
\item
  Álgebra Matricial
\item
  Vetores e escalares
\item
  Matrizes
\item
  Sistemas de equações lineares
\item
  Decomposições matriciais
\item
  Métodos Numéricos
\item
  Sistemas de equações não-lineares
\item
  Diferenciação e integração numérica
\item
  Otimização
\end{itemize}

\hypertarget{exemplos-motivacionais}{%
\subsection{Exemplos motivacionais:}\label{exemplos-motivacionais}}

\hypertarget{classificador-binuxe1rio}{%
\subsubsection{Classificador binário}\label{classificador-binuxe1rio}}

Ferramenta popular em modelagem estatística e aprendizagem de maquina

Objetivo: classificar um individuo ou observação em uma entre duas
categorias

Exemplos:

\begin{itemize}
\tightlist
\item
  Classificar um paciente como sadio ou doente
\item
  Classificar um cliente como bom ou mal pagador etc
\end{itemize}

\hypertarget{diversos-algoritmos-disponuxedveis}{%
\subsection{Diversos algoritmos
disponíveis:}\label{diversos-algoritmos-disponuxedveis}}

\begin{itemize}
\tightlist
\item
  Arvores de classificação
\item
  Máquinas de vetores de suporte
\item
  Redes neurais
\item
  Gradient boost
\item
  Regressão logística é muito popular
\end{itemize}

\hypertarget{descriuxe7uxe3o-matemuxe1tica}{%
\subsection{Descrição matemática:}\label{descriuxe7uxe3o-matemuxe1tica}}

\begin{itemize}
\tightlist
\item
  Suponha que temos um conjunto de dados \(y_{i}\) para \(i=1,…,n\) .
\item
  Cada \(y_{i} \in [0,1]\) (é zero ou 1) -\textgreater{} sim ou não,
  saudável ou doente etc
\end{itemize}

Potenciais objetivos:

\begin{itemize}
\tightlist
\item
  Descrever o relacionamento de \(y_{i}\) com um conjunto de variáveis
  explanatórios \(x_{ij}\) com \(j=1,…,p\)
\item
  Classificar uma nova observação como 0 ou 1
\end{itemize}

Exemplo - Conjunto de dados com 3 colunas:

\begin{itemize}
\tightlist
\item
  Renda anual do usuário
\item
  Anos de experiencia do usuário
\item
  Se é premium ou não
\end{itemize}

Objetivos:

\begin{itemize}
\tightlist
\item
  Identificar como as covariáveis renda e anos influenciem a compra
  premium
\item
  Predizer se um novo usuário será ou não premium
\item
  Orientar campanha de marketing
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dados\_reg\_log }\OtherTok{\textless{}{-}} \FunctionTok{read.table}\NormalTok{(}\StringTok{"./Data\_Files/reg\_log.txt"}\NormalTok{, }\AttributeTok{header =} \ConstantTok{TRUE}\NormalTok{)}

\FunctionTok{head}\NormalTok{(dados\_reg\_log,}\AttributeTok{n =}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Premium    Renda Anos
## 1        0 18.90256    4
## 2        1 38.66267    7
## 3        1 82.16108    4
## 4        1 22.34817    8
## 5        1 36.13398    9
## 6        0 52.61761    2
## 7        1 55.36645    5
## 8        1 30.78107    8
## 9        0 21.95257    5
## 10       0 53.84225    5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(dados\_reg\_log}\SpecialCharTok{$}\NormalTok{Anos, dados\_reg\_log}\SpecialCharTok{$}\NormalTok{Renda, }\AttributeTok{main =} \StringTok{"Anos de Exp vs Renda"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{04-Caderno_Inferencia_Estatistica_files/figure-latex/chunk-2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\NormalTok{grafico }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(dados\_reg\_log,}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Anos, }\AttributeTok{y =}\NormalTok{ Renda, }\AttributeTok{colour =}\NormalTok{ Premium)) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()}

\NormalTok{grafico}
\end{Highlighting}
\end{Shaded}

\includegraphics{04-Caderno_Inferencia_Estatistica_files/figure-latex/chunk-3-1.pdf}

\(i\) \(y\) \(=f(\) \(x_{i1} = renda\) \(x_{i2} = anos)\)

\(y_{i} = f (x_{ij})\) \(y_{i} = f(x_{ij})+erro\)
\(erro = y_{i}-f (x_{ij} )\)

Construção do classificador:

\begin{itemize}
\tightlist
\item
  Explicar o modelo que descreve a relação entre \(y_{i}\) e \(x_{ij}\)
  (i linha-usuário, j coluna-covariável)
\end{itemize}

\(y=f(renda,xp)\), ou seja, y é função dependente de renda e xp

\begin{itemize}
\tightlist
\item
  Especificar função perda (medida de erro)
\end{itemize}

\(erro=g( y_{i},f(x_{ij}))\) função g

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{f\_logit }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(par, y, renda, anos)\{}
\NormalTok{  mu }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{+}\FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{(par[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ par[}\DecValTok{2}\NormalTok{]}\SpecialCharTok{*}\NormalTok{renda }\SpecialCharTok{+}\NormalTok{ par[}\DecValTok{3}\NormalTok{]}\SpecialCharTok{*}\NormalTok{anos)))}
\NormalTok{  SQ\_logit }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{((y }\SpecialCharTok{{-}}\NormalTok{ mu)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
  \FunctionTok{return}\NormalTok{(SQ\_logit)}
\NormalTok{\}}


\CommentTok{\#f\_logit()}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Características satisfaça duas equações de distância:
  \(d(y,\mu)>0 | y= \mu\) e \(d(y,\mu)=0 | \mu=f(x_{ij})\)
\end{itemize}

Otimizar a função perda:

\begin{itemize}
\tightlist
\item
  Qual algoritmo escolher?
\item
  Como implementá-la?
\item
  Analisar o modelo ajustando
\end{itemize}

\hypertarget{kmeans}{%
\subsection{Kmeans}\label{kmeans}}

Clusterização usando kmeans

\begin{itemize}
\tightlist
\item
  Agrupar indivíduos semelhantes
\item
  Individuos no mesmo grupo sejam mais parecidos do que indivíduos em
  grupos diferentes
\item
  Distância da media
\end{itemize}

\hypertarget{math-part}{%
\section{Math part}\label{math-part}}

\hypertarget{linha-reta}{%
\subsection{Linha reta}\label{linha-reta}}

\[y_{i} = \beta_{0} + \beta_{1} * renda\]

\hypertarget{sigmoide}{%
\subsection{Sigmoide}\label{sigmoide}}

\[y_{i} = \frac{1}{1 + exp^{ -(\beta_{0} + \beta_{1} * renda +  \beta_{2} * anos)}} \]

Combinando o modelo logistico com a função perda

\[SQ_{logit}(\beta) = \sum_{i=1}^{n}(y_{1} - \frac{1}{1 + exp^{ -(\beta_{0} + \beta_{1} * renda +  \beta_{2} * anos)}})^2 \]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# f\_logit \textless{}{-} funcao(par, y, renda, anos) \{}
\CommentTok{\#   mu \textless{}{-} 1 / (1 + exp({-}(par[1] + par[2] * renda + par[3] * anos)))}
\CommentTok{\#   SQ\_logit \textless{}{-} sum((y {-} mu) \^{} 2)}
\CommentTok{\#   return(SQ\_logit)}
\CommentTok{\# \}}
\end{Highlighting}
\end{Shaded}

\hypertarget{cuxe1lculo-diferencial-e-integral}{%
\section{Cálculo Diferencial e
Integral}\label{cuxe1lculo-diferencial-e-integral}}

\hypertarget{problemas-convencionais-em-ciuxeancia-de-dados}{%
\subsection{Problemas convencionais em ciência de
dados}\label{problemas-convencionais-em-ciuxeancia-de-dados}}

\begin{itemize}
\item
  Problemas convencionais em ciência de dados
\item
  Previsão ou predição → O que vai acontecer?
\item
  Classificação → Qual o tipo de um determinado objeto?
\item
  Agrupamento → Qual a melhor forma de agregar objetos?
\item
  Prescrição → O que devo fazer?
\item
  Como resolvê-los?
\item
  Em geral usamos algum tipo de modelo.
\item
  O que é um modelo?
\item
  Representação simplificada da realidade.
\item
  Qual o objetivo de um modelo?
\item
  Representar como o cientista imagina ou supõe que a realidade está
  sendo gerada e refletida por meio dos dados.
\item
  Características de um bom modelo
\item
  Deve representar os principais aspectos do fenômeno sendo avaliado.
\item
  Pode conter uma ou mais quantidades desconhecidas (parâmetros).
\item
  Deve permitir generalizações.
\item
  Deve fornecer um resumo rápido e interpretável do fenômeno em estudo.
\item
  Deve ser matematicamente preciso e coerente.
\end{itemize}

\hypertarget{funuxe7uxf5es}{%
\subsection{Funções}\label{funuxe7uxf5es}}

\begin{itemize}
\tightlist
\item
  Definição: uma função escrita como \(y = f(x)\) associa um número
  \(y\) a cada valor de \(x\).
\item
  \(x\) é chamada de variável independente.
\item
  Domínio de \(f(x)\) é a faixa de valores que \(x\) pode assumir.
\item
  \(y\) é chamada de variável dependente.
\item
  Imagem de \(f(x)\) é a faixa de valores que \(y\) pode assumir.
\item
  Resumindo temos,
\end{itemize}

\[ \frac{x \in Dominio}{Independente} \longrightarrow f(x) \longrightarrow \frac{x \in Imagem}{Dependente}\]

\begin{itemize}
\item
  O domínio e imagem de uma função são intervalos.
\item
  Tipos de intervalos:

  \begin{itemize}
  \tightlist
  \item
    Intervalo aberto não contém as extremidades: Notação (a,b).
  \item
    Intervalo fechado contém as extremidades: Notação {[}a,b{]}.
  \end{itemize}
\item
  O que entra e o que sai de uma função?

  \begin{itemize}
  \tightlist
  \item
    Naturais: \$ \{N\} = \{0, 1, 2, 3\ldots\} \$ \{N\} = \{0,1,2,3,
    \ldots{} \}\$.
  \item
    Inteiros: \({Z} = {… , -3, -2, -1, 0, 1,2,3, …}\)
  \item
    Racionais \({Q} = {ab |a, b \in {Z}, b {!=} 0}\)
  \item
    Irracionais: Conjunto de números que não são racionais.
  \item
    Reais: União de todos os números mencionados acima, notação \{R\}.
  \end{itemize}
\item
  Distinção importante \({R}\) (double) e \({Z}\) (integer).
\item
  Considere a função \(y = x^2\).
\item
  Em R temos
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{minha\_funcao }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{  y }\OtherTok{\textless{}{-}}\NormalTok{ x}\SpecialCharTok{\^{}}\DecValTok{2}
  \FunctionTok{return}\NormalTok{(y)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Avaliando a função em alguns pontos.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x\_vec }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{4}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}
\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{) }\CommentTok{\#concatenação}
\FunctionTok{minha\_funcao}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x\_vec) }\CommentTok{\#automaticamente vetorizado}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 25 16  9  4  1  0  1  4  9 16 25
\end{verbatim}

\hypertarget{funuxe7uxf5es-unidimensionais}{%
\subsection{Funções
unidimensionais}\label{funuxe7uxf5es-unidimensionais}}

\begin{itemize}
\tightlist
\item
  Uma função \(y = f(x)\) é dita ser de apenas uma variável
  (unidimensional). Ou seja, só uma entrada
\item
  Pode ser desenhada em um espaço bidimensional, o chamado \(R_{2}\).
  Gafico de \(x\) e \(y\)
\item
  O espaço \(R_{2}\) é formado por todas as duplas ordenadas de valores
  reais.
\item
  A variável dependente \(y\) é representada no eixo vertical.
\item
  A variável dependente \(x\) é representada no eixo horizontal.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Avaliando a função}
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{minha\_funcao}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x\_vec)}
\DocumentationTok{\#\# Gráfico da função}
\FunctionTok{plot}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x\_vec, }\AttributeTok{xlab =} \StringTok{"x"}\NormalTok{, }\AttributeTok{type =} \StringTok{"l"}\NormalTok{,}
\AttributeTok{ylab =} \FunctionTok{expression}\NormalTok{(}\AttributeTok{y =} \FunctionTok{f}\NormalTok{(x)))}
\FunctionTok{points}\NormalTok{(x\_vec,y)}
\end{Highlighting}
\end{Shaded}

\includegraphics{04-Caderno_Inferencia_Estatistica_files/figure-latex/unnamed-chunk-2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# ou com GGPLOT}

\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(x\_vec,y))}
\end{Highlighting}
\end{Shaded}

\includegraphics{04-Caderno_Inferencia_Estatistica_files/figure-latex/unnamed-chunk-2-2.pdf}

\hypertarget{funuxe7uxf5es-parametrizadas}{%
\subsection{Funções parametrizadas}\label{funuxe7uxf5es-parametrizadas}}

\begin{itemize}
\tightlist
\item
  Definição - parâmetro é uma quantidade conhecida que indexa ou
  parametriza uma determinada função.
\item
  Os parâmetros mudam o comportamento da função e descrevem
  quantidades/características de interesse.
\item
  Notação: \(y = f(x - \theta)\), onde \(\theta\) denota o parâmetro.
\item
  O conjunto de valores que \(\theta\) (theta minusculo) pode assumir é
  chamado de espaço paramétrico (theta maiusculo).
\item
  Notação \[\theta \in \Theta \]
\item
  Exemplo: \(y = (x - \theta)^2\). Theta joga o grafico mais para
  direita ou esquerda
\item
  Computacionalmente:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fx }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x, theta) \{}
\NormalTok{out }\OtherTok{\textless{}{-}}\NormalTok{ (x }\SpecialCharTok{{-}}\NormalTok{ theta)}\SpecialCharTok{\^{}}\DecValTok{2}
\FunctionTok{return}\NormalTok{(out)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Criar grafico}
\end{Highlighting}
\end{Shaded}

\hypertarget{funuxe7uxf5es-com-vuxe1rios-paruxe2metros}{%
\subsection{Funções com vários
parâmetros}\label{funuxe7uxf5es-com-vuxe1rios-paruxe2metros}}

\begin{itemize}
\tightlist
\item
  Em geral uma função pode ter vários parâmetros.
\item
  O ideal é que cada parâmetro controle um aspecto da função.
\item
  Exemplo: \(y = f(x; \theta)\), onde \(\theta\) é um vetor de
  parâmetros.
\item
  Função com dois parâmetros:
  \[ y = \frac{(x - \theta_{1})^2}{\theta_{2}}\]
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Criar grafico}
\end{Highlighting}
\end{Shaded}

\hypertarget{declividade}{%
\subsection{Declividade}\label{declividade}}

\begin{itemize}
\tightlist
\item
  A declividade mede a variação ``delta maiusculo'' no valor de y
  dividido pela variação no valor de x, ou seja, declividade é
  \[ \frac{\Delta y}{\Delta x}\] (quanto varia y quando mudamos x).
\item
  A declividade do desenho de uma função pode ser constante (A),
  positiva (B) ou negativa (C).
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Criar grafico}
\end{Highlighting}
\end{Shaded}

Figura 4. Exemplos de declividade.

\begin{itemize}
\tightlist
\item
  O intercepto vertical é o ponto no qual o gráfico cruza o eixo
  vertical e é obtido quando \(x = 0\).
\end{itemize}

\hypertarget{funuxe7uxf5es-com-duas-ou-mais-variuxe1veis-independentes}{%
\subsection{Funções com duas ou mais variáveis
independentes}\label{funuxe7uxf5es-com-duas-ou-mais-variuxe1veis-independentes}}

Funções com duas ou mais variáveis independentes - Definição - uma
função escrita como \(y = f(x)\) associa um número \(y\) a cada vetor de
entrada \(x\). (\textbf{Atenção}: \(x\) é um vetor nesse caso!) -
\(x = (x_1, … , x_p)^T\) denota um vetor linha transposto (vetor
coluna). - Exemplo: considere a função de duas variáveis \(x_1\) e
\(x_2\) definida por

\[ f(x1, x2) = \sqr(25 - x21- x22)\] ,avalie a função nos pontos
\(x = (0, 0)^T\), \(x = (3, 0)^T\) e desenhe seu gráfico. - Avaliando
nos pontos {[}{[}ARRUMAR{]}{]} y = \sqr
25 - 02 - 02 = 5 e y = \sqr
25 - 32 - 02 = 4.

Computacionalmente - Implementação computacional

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fx1x2 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{y }\OtherTok{=} \FunctionTok{sqrt}\NormalTok{(}\DecValTok{25} \SpecialCharTok{{-}}\NormalTok{ x[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{{-}}\NormalTok{ x[}\DecValTok{2}\NormalTok{]}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\FunctionTok{return}\NormalTok{(y)}
\NormalTok{\}}
\NormalTok{entrada1 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{0}\NormalTok{)}
\NormalTok{entrada2 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{0}\NormalTok{)}
\FunctionTok{fx1x2}\NormalTok{(}\AttributeTok{x =}\NormalTok{ entrada1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [1] 5}
\FunctionTok{fx1x2}\NormalTok{(}\AttributeTok{x =}\NormalTok{ entrada2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [1] 4}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Avaliando uma função bidimensional.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{entrada }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(entrada1, entrada2),}
                  \AttributeTok{ncol =} \DecValTok{2}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{2}\NormalTok{,}
                  \AttributeTok{byrow =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{entrada}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]    0    0
## [2,]    3    0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [,1] [,2]}
\DocumentationTok{\#\# [1,] 0 0}
\DocumentationTok{\#\# [2,] 3 0}

\NormalTok{saida }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{) \{}
\NormalTok{  saida[i] }\OtherTok{\textless{}{-}} \FunctionTok{fx1x2}\NormalTok{(entrada[i,])}
\NormalTok{\}}
\NormalTok{saida}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [1] 5 4}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  O gráfico da função é o conjunto das triplas ordenadas (y, x1, x2) que
  satisfazem a função.
\end{itemize}

\hypertarget{passo-a-passo-para-desenhar-funuxe7uxf5es-bidimensionais}{%
\subsection{Passo-a-passo para desenhar funções
bidimensionais}\label{passo-a-passo-para-desenhar-funuxe7uxf5es-bidimensionais}}

\begin{itemize}
\item
  Neste caso estamos no espaço \(R_3\).
\item
  \begin{enumerate}
  \def\labelenumi{(\Alph{enumi})}
  \tightlist
  \item
    Montar uma grade de valores combinando valores para x1 com valores
    para x2.
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{(\Alph{enumi})}
  \setcounter{enumi}{1}
  \tightlist
  \item
    Avaliar a função em cada um dos pontos criados.
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{(\Alph{enumi})}
  \setcounter{enumi}{2}
  \tightlist
  \item
    Representar o valor da função no gráfico. Neste caso usando uma
    paleta de cores. (poderia ser uma topografia, seria uma hemi-esfera)
  \end{enumerate}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Fazer grafico}
\end{Highlighting}
\end{Shaded}

Figura 5. Passo-a-passo para desenhar uma função de duas variáveis
independentes.

Gráficos bidimensionais - Em geral usamos uma grade mais precisa.

curva de nivel ou iso-linha

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Fazer grafico}
\end{Highlighting}
\end{Shaded}

Figura 6. Ilustração do gráfico de uma função de duas variáveis de
entrada.

\hypertarget{funuxe7uxf5es-multidimensionais}{%
\subsection{Funções
multidimensionais}\label{funuxe7uxf5es-multidimensionais}}

\begin{itemize}
\tightlist
\item
  Definição - uma função escrita como \(y = f(x; \theta)\) associa um
  número \(y\) a cada vetor de entrada \(x\) e \(\theta\) denota um
  vetor de parâmetros conhecidos.
\item
  Para funções com mais de duas variáveis de entrada não temos uma forma
  simples de representação gráfica.
\item
  Em termos práticos as funções vão representar ou modelar situações
  reais.
\item
  Precisamos de funções flexíveis para representar fenômenos complexos.
\end{itemize}

\hypertarget{funuxe7uxf5es-polinuxf4miais}{%
\subsubsection{Funções polinômiais}\label{funuxe7uxf5es-polinuxf4miais}}

\begin{itemize}
\item
  Funções polinômiais são funções do tipo
  \[ y = \beta_{0} + \beta_{1}x + \beta_{2}\] \[x^2 + … \beta_{p} x^p\]
\item
  Exemplo: funções polinômiais de grau até três.

  \begin{itemize}
  \tightlist
  \item
    Função linear: \[y = \beta_0 + \beta_1x\]
  \item
    Função quadrática: \[y = \beta_0 + \beta_1x + \beta_2x^2\]
  \item
    Função cúbica: \[y = \beta_0 + \beta_1x + \beta_2x^2 + \beta_3x^3\]
  \end{itemize}
\item
  O gráfico de uma função quadrática é uma parábola aberta para cima se
  \(\beta_2 > 0\) ou para baixo se \(\beta_2 < 0\)
\item
  Graficamente:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Fazer grafico}
\end{Highlighting}
\end{Shaded}

Figura 8. Exemplos de gráficos de funções polinômiais.

Funções do tipo potência - Funções do tipo potência são funções da forma
\[y = x^a\] em que a é um expoente constante. - Por definição, \$x\^{}0
= 1 \$ e note que um número sem expoente está elevado a 1. 1.
\[xa(x𝑐) = xa+𝑐;\] 2. \[(xa)𝑐 = xa𝑐;\] 3. \[3. (x𝑧)a = xa(𝑧a);\] 4.
\[4. (x𝑧 )𝑐 = x𝑐 𝑧𝑐 ;\] 5. \[5. 1 xa = x-a;\] 6. \[6. xa x𝑐 = xa-𝑐;\] 7.
\[7. \sqr x = x1/2;\] 8. \[8. a \sqrx = x1/a;\] 9.
\[9. 𝑐 \sqrxa = xa/𝑐.\]

\hypertarget{funuxe7uxf5es-exponenciais}{%
\subsection{Funções exponenciais}\label{funuxe7uxf5es-exponenciais}}

\begin{itemize}
\item
  Funções exponenciais são funções do tipo \(y = a^x\) onde a é maior
  que zero e diferente de 1 e \(x\) é o expoente.
\item
  Funções exponenciais naturais são funções exponenciais que tem como
  base \[\lim_{n \to \infty} (1 + \frac{1}{n})n = 2.718281828\]
\item
  Propriedades importantes: \[
  \]
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \[e0 = 1.\]
\item
  \[e1 = 𝑒 = 2.71828\]
\item
  \[e(𝑒b) = 𝑒a+b.\]
\item
  \[(𝑒a)b = 𝑒ab\]
\item
  \[𝑒a𝑒b = 𝑒a-b.\]
\end{enumerate}

\hypertarget{funuxe7uxf5es-logaruxedtmicas}{%
\subsection{Funções logarítmicas}\label{funuxe7uxf5es-logaruxedtmicas}}

\begin{itemize}
\tightlist
\item
  Funções logarítmicas ou logaritmo é a potência à qual uma dada base
  deve ser elevada para se obter um particular número.
\item
  Logaritmos comuns utilizam a base 10 e são escritos log10.
\item
  Por exemplo, uma vez que \(10^2 = 100\), 2 é o log de 100.
\item
  Para qualquer função exponencial \(y = a^x\), onde a é a base e \(x\)
  o expoente, \(a\) potência à qual a deve ser elevado, para obter-se
  \(y\).
\end{itemize}

{[}{[}ARRUMAR{]}{]} log a \$y = x x é

\hypertarget{relauxe7uxf5es-entre-funuxe7uxf5es-logaruxedtmicas-e-exponenciais.}{%
\subsection{Relações entre funções logarítmicas e
exponenciais.}\label{relauxe7uxf5es-entre-funuxe7uxf5es-logaruxedtmicas-e-exponenciais.}}

\begin{itemize}
\tightlist
\item
  Se \(\log_{10}(y) = 2x\), então \(y = 10^{2x}\).
\item
  Se \(\log_{a}(y) = xz\), então \(y = a^{xz}\).
\item
  Se \(\ln(y) = 5t\), então \(y = e^{5t}\).
\item
  Se \(y = a^{3x}\), então \(\log_a(y) = 3x\).
\item
  Se \(y = 10^{6x}\), então \(\log_{10}(y) = 6x\).
\item
  Se \(y = e^{t+1}\), então \(\ln(y) = t+1\) \textbf{Observação}:
  \(e = 2.718281828459045\) = número de Euler.
\end{itemize}

\hypertarget{outras-funuxe7uxf5es-de-interesse}{%
\subsection{Outras funções de
interesse}\label{outras-funuxe7uxf5es-de-interesse}}

\begin{itemize}
\tightlist
\item
  Sigmóide ou logística: \(y = 1 1+𝑒-x\)
\item
  Tangente hiperbólica: \(y = 𝑒x-𝑒-x 𝑒x+𝑒-x\) .
\item
  Linear retificada (ReLU): \(y = max{0,x}\). (maximo entre 0 e x?. Vale
  0 até o 0 e depois ``sobe'')
\item
  Leaky ReLU: \(y = max{𝛼x, x}\), onde \(\alpha\) é uma parâmetro
  conhecido.
\end{itemize}

\#\#Desenho do gráfico das funções

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#desenho aqui}
\end{Highlighting}
\end{Shaded}

\hypertarget{normal}{%
\subsection{Normal}\label{normal}}

\[ y= (x-0)^2/\theta\]

\[ exp{-(n - \theta_{1})^2/ \theta_{2}}\]

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# fazer grafico}
\end{Highlighting}
\end{Shaded}

{[}{[}ARRUMAR{]}{]} \ldots..normal

\hypertarget{limites-e-continuidade}{%
\subsection{Limites e continuidade}\label{limites-e-continuidade}}

Limite de uma função - Definição - se uma função \(f(x)\) se aproxima de
um número \(L\) conforme \(x\) tende a um número a vindo da direita ou
da esquerda, dizemos que o limite de \(f(x)\) tende a \(L\) quando \(x\)
tende a \(a\). - Notação \[\lim_{x \to a} f(x) = f(a) = L\]

\begin{itemize}
\item
  O limite pode não existir.
\item
  Se o limite de uma função existe ele é único.
\item
  Considere o limite \[\lim_{x \to 1} x+1 = 2\]
\item
  Exemplo:

  \begin{itemize}
  \tightlist
  \item
    Considere o limite
  \end{itemize}
\end{itemize}

\[\lim_{x \to 1} x^2\]

{[}{[}ARRUMAR{]}{]} lim x→1 x2 - 1 x - 1 = ?

é 2

\begin{itemize}
\tightlist
\item
  Computacionalmente
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fx }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{out }\OtherTok{\textless{}{-}}\NormalTok{ (x}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\NormalTok{(x }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)}
\FunctionTok{return}\NormalTok{(out)}
\NormalTok{\}}
\FunctionTok{fx}\NormalTok{(}\AttributeTok{x =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] NaN
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [1] NaN}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Figura 11. Desenho do gráfico da função}
\end{Highlighting}
\end{Shaded}

Exemplo - Note que \[
\] {[}{[}ARRUMAR{]}{]}

\begin{itemize}
\tightlist
\item
  Definição intuitiva: o limite de uma função é o valor que achamos
  natural para ela em um determinado ponto.
\item
  Essa função não é continua (no ponto)
\end{itemize}

\hypertarget{continuidade-de-uma-funuxe7uxe3o}{%
\subsection{Continuidade de uma
função}\label{continuidade-de-uma-funuxe7uxe3o}}

\begin{itemize}
\tightlist
\item
  Definição - dizemos que uma função é contínua em \(x = a\) se três
  condições forem satisfeitas:

  \begin{itemize}
  \tightlist
  \item
    \(f(a)\) existe,
  \item
    \(\lim_{x \to a} f(x)\) existe e
  \item
    \(\lim_{x \to a} f(x) = f(a)\).
  \end{itemize}
\item
  Continuidade significa que pequenas variações na variável independente
  levam a pequenas variações na variável dependente.(mudanças suaves, ou
  não abruptas)
\item
  Teorema do valor intermediário: se a função \(f(x)\) é contínua no
  intervalo fechado \([a,b]\), então existe pelo menos um número \(c\)
  em \([a,b]\) tal que \(f(c) = M\)
\item
  Implicação: se \(f(x)\) é contínua seu gráfico não contém salto
  vertical.
\item
  Em geral podemos pensar em funções contínuas como sendo funções
  suaves.
\end{itemize}

\hypertarget{funuxe7uxe3o-nuxe3o-contuxednua}{%
\subsubsection{Função não
contínua}\label{funuxe7uxe3o-nuxe3o-contuxednua}}

\begin{itemize}
\tightlist
\item
  Considere a função não continua em 0. \[
  \lim_{x \to 0} \frac{|x|}{x} = \{-1   x < 0 e 1 x > 0
  \]
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Figura 12. Função descontinua.}
\end{Highlighting}
\end{Shaded}

Propriedades de limites - Se

\[\lim_{x \to p} f(x) = L_1\] e

\[\lim_{x \to p} g(x) = L_2\] então

\[\lim_{x \to p} [f(x) + g(x)] = L_1 + L_2\]
\[\lim_{x \to p} k f(x) = k\] \[\lim_{x \to p} f(x) = k L_1\]

\[\lim_{x \to p} f(x) g(x) = \lim_{x \to p} f(x) * \lim_{x \to p} g(x) = L_1 * L_2\]
\[\lim_{x \to p} f(x) g(x) = L_1 * L_2\] , desde que \(L_2 \neq 0\).

\hypertarget{derivadas}{%
\subsection{Derivadas}\label{derivadas}}

\begin{itemize}
\tightlist
\item
  Definição - derivada ordinária, derivada primeira, ou simplesmente,
  derivada de uma função \(y = f(x)\) em um ponto \(x = a\) no domínio
  de \(f\) é representada por \[\frac{dy}{dx}\] ou \[y′\] ou
  \[\frac{df}{dx}\] ou \[f′(a)\] é o valor
\end{itemize}

\[ \frac{dy}{dx} | x=a = f′(a)\] {[}{[}ARRUMAR{]}{]}

\[
\lim_{h \to 0}  = \frac{f(a+h)-f(a)}h
\]

\begin{itemize}
\tightlist
\item
  Interpretação da derivada
\item
  Taxa de mudança instântanea.
\item
  No limite quando \(x \longrightarrow a\) a derivada é a reta tangente
  ao ponto \((a, f(a))\).
\item
  Equação da \textbf{reta tangente} ao ponto a:
  \(y - f(a) = f′(a)(x - a)\).(coenficiente angular é
  \(\beta 1 -> y = \beta_0 + \beta_1*x)\) {[}{[}ARRUMAR{]}{]}
\end{itemize}

\hypertarget{exemplo}{%
\subsection{Exemplo}\label{exemplo}}

Obtenha a derivada de \(f(x) = -x^2\) \[
f'(x) = \lim_{h \to 0} \frac{f(x + h) - f(x)}{h}
\] \[
= \lim_{h \to 0} \frac{-(x + h)^2 - (-x2)}{h}
\] \[
= \lim_{h \to 0} \frac{-(x^2 + 2xh + h^2) + x^2}{h}
\] \[
= \lim_{h \to 0} \frac{-x^2 - 2xh - h^2 + x^2}{h}
\] \[
= \lim_{h \to 0} \frac{- 2xh - h^2}{h}
\]

\[
= \lim_{h \to 0} - 2x - h = -2x
\] \[
= f′(x) = -2x
\]

{[}{[}CONFERIR{]}{]}

Obtenha a reta tangente a \(f(x)\) nos pontos \(x = 2\) e \(x = -2\). -
Temos: \[f(x = 2) = -4\] \[f′(x = 2) = -4\] assim
\[y - f(x = 2) = f′(x = 2)(x - 2)\] \[y - (-4) = -4(x - 2)\]
\[y + 4 = = -4x + 8\] \[y = 4 - 4x\] - Computacionalmente - f(x) e
f′(x).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fx }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{out }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\NormalTok{ x}\SpecialCharTok{\^{}}\DecValTok{2}
\FunctionTok{return}\NormalTok{(out)}
\NormalTok{\}}
\NormalTok{f\_prime }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{out }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{2}\SpecialCharTok{*}\NormalTok{x}
\FunctionTok{return}\NormalTok{(out)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Equação da reta y = a + b ∗ x.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{intercept }\OtherTok{=}\NormalTok{ (}\FunctionTok{fx}\NormalTok{(}\AttributeTok{x =} \DecValTok{2}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{f\_prime}\NormalTok{(}\AttributeTok{x =} \DecValTok{2}\NormalTok{)}\SpecialCharTok{*}\DecValTok{2}\NormalTok{)}
\NormalTok{slope }\OtherTok{\textless{}{-}} \FunctionTok{f\_prime}\NormalTok{(}\AttributeTok{x =} \DecValTok{2}\NormalTok{)}
\FunctionTok{c}\NormalTok{(intercept, slope)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  4 -4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [1] 4 {-}4}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Figura 14. Desenho de uma função e retas tangentes.}
\end{Highlighting}
\end{Shaded}

\hypertarget{regras-de-derivauxe7uxe3o}{%
\subsection{Regras de derivação}\label{regras-de-derivauxe7uxe3o}}

\begin{itemize}
\tightlist
\item
  Seja \(n \neq 0\) um natural. São válidas as fórmulas de derivação:
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Se \(f(x) = c\) então \(f′(x) = 0\).
\item
  Se \(f(x) = xn\) então \(f′(x) = n * n^-1\)
\item
  Se \(f(x) = x-n\) então \(f′(x) = -n * -n^{-1}\)
\item
  Se \(f(x) = \frac{x_1}{n}\) então
  \(f′(x) = \frac{1}{n} * \frac{x_1}{n} -1\)
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Derivada de funções especiais
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\tightlist
\item
  Se \(f(x) = exp(x)\) então \(f′(x) = exp(x)\).
\item
  Se \(f(x) = ln(x)\) então \(f′(x) = 1x, x > 0\)
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Sendo, \(f(x)\) e \(g(x)\) deriváveis em \(x\) e \(c\) uma constante.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{6}
\tightlist
\item
  (f + 𝑔)′ = f′(x) + 𝑔′(x).
\item
  (𝑐f)′(x) = 𝑐f′(x).
\item
  (f ⋅ 𝑔)′(x) = f′(x)𝑔(x) + f(x)𝑔′(x).
\item
  ( f 𝑔 )′(x) = f′(x)𝑔(x)-f(x)𝑔′(x) {[}𝑔(x){]}2 .
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Exemplo: obtenha a derivada de f(x) = 2 + 3x.
\item
  Solução: f′(x) = 3.
\item
  Computacionalmente
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{D}\NormalTok{(}\FunctionTok{expression}\NormalTok{(}\DecValTok{2} \SpecialCharTok{+} \DecValTok{3}\SpecialCharTok{*}\NormalTok{x), }\AttributeTok{name =} \StringTok{"x"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [1] 3}
\end{Highlighting}
\end{Shaded}

\hypertarget{regra-da-cadeia}{%
\subsection{Regra da cadeia}\label{regra-da-cadeia}}

\begin{itemize}
\tightlist
\item
  ``Uma função dentro da outra''
\item
  Sejam y = f(x) e x = 𝑔(𝑡) duas funções deriváveis, com 𝐼 \in 𝐷f . A
  função composta ℎ(𝑡) = f(𝑔(𝑡)) é derivável, sendo ℎ′(𝑡) =
  f′(𝑔(𝑡))𝑔′(𝑡), 𝑡 \in 𝐷𝑔.
\item
  Existe uma infinidade de fórmulas de derivação.
\item
  Na prática é comum usar um software de matemática simbólica como o
  wxMaxima.
\item
  Em R as funções deriv() e deriv3().
\end{itemize}

\hypertarget{exemplo-regra-da-cadeia}{%
\subsection{Exemplo regra da cadeia}\label{exemplo-regra-da-cadeia}}

\begin{itemize}
\tightlist
\item
  Obtenha a derivada de sin(2x3 - 4x).
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Note que temos uma função composta (derivada de sen e cos) sin(𝑔(x)),
  onde 𝑔(x) = 2x3 - 4x.
\item
  Usando a regra da cadeia temos: f′(𝑔(x)) = cos(2x3 - 4x) and 𝑔′(x) =
  6x2 - 4.
\item
  Assim, a derivada fica dada por cos(2x3 - 4x) ⋅ (6x2 - 4).
\item
  Computacionalmente
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{D}\NormalTok{(}\FunctionTok{expression}\NormalTok{( }\FunctionTok{sin}\NormalTok{(}\DecValTok{2}\SpecialCharTok{*}\NormalTok{x}\SpecialCharTok{\^{}}\DecValTok{3} \SpecialCharTok{{-}} \DecValTok{4}\SpecialCharTok{*}\NormalTok{x)), }\AttributeTok{name =} \StringTok{"x"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## cos(2 * x^3 - 4 * x) * (2 * (3 * x^2) - 4)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# cos(2 * x\^{}3 {-} 4 * x) * (2 * (3 * x\^{}2) {-} 4)}
\DocumentationTok{\#\# ou cos(2x\^{}3 {-} 4x) * (6x\^{}2) {-} 4)}

\FunctionTok{D}\NormalTok{(}\FunctionTok{D}\NormalTok{(}\FunctionTok{expression}\NormalTok{( }\FunctionTok{sin}\NormalTok{(}\DecValTok{2}\SpecialCharTok{*}\NormalTok{x}\SpecialCharTok{\^{}}\DecValTok{3} \SpecialCharTok{{-}} \DecValTok{4}\SpecialCharTok{*}\NormalTok{x)), }\AttributeTok{name =} \StringTok{"x"}\NormalTok{), }\AttributeTok{name =} \StringTok{"x"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## cos(2 * x^3 - 4 * x) * (2 * (3 * (2 * x))) - sin(2 * x^3 - 4 * 
##     x) * (2 * (3 * x^2) - 4) * (2 * (3 * x^2) - 4)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# cos(2 * x\^{}3 {-} 4 * x) * (2 * (3 * (2 * x))) {-} sin(2 * x\^{}3 {-} 4 * x) * (2 * (3 * x\^{}2) {-} 4) * (2 * (3 * x\^{}2) {-} 4)}
\end{Highlighting}
\end{Shaded}

\hypertarget{derivadas-de-ordem-superior}{%
\subsection{Derivadas de ordem
superior}\label{derivadas-de-ordem-superior}}

\begin{itemize}
\tightlist
\item
  A derivada f′(x) é também chamada de derivada de primeira ordem e mede
  a variação da função original ou primitiva.
\item
  A derivada de segunda ordem denotada por f′′(x) mede a taxa de
  variação da primeira derivada.
\item
  A derivada de terceira ordem f′′′(x) mede a taxa de variação da
  segunda derivada e assim por diante até a 𝑛-ésima derivada.
\item
  Notação comum: 𝑑𝑛y 𝑑x𝑛 que é interpretada como a 𝑛-ésima derivada de y
  em relação a x
\item
  Exemplo: obtenha as derivadas até a ordem 5 da função y = 2x4 + 5x3 +
  2x2. 𝑑y 𝑑x = 8x3 + 15x2 + 4x, 𝑑2y 𝑑x2 = 24x2 + 30x + 4, 𝑑3y 𝑑x3 = 48x
  + 30, 𝑑4y 𝑑x4 = 48 e 𝑑5y 𝑑x5 = 0. daqui em diante é zero
\end{itemize}

\hypertarget{muxe1ximos-e-muxednimos}{%
\subsection{Máximos e mínimos}\label{muxe1ximos-e-muxednimos}}

\begin{itemize}
\tightlist
\item
  Dizemos que um ponto \(c\) é um valor máximo relativo de \(f(x)\) se
  existir um intervalo aberto contendo \(c\), no qual \$f(x)\$4 esteja
  definida, tal que \(f(c) >= f(x)\) para todo \(x\) neste intervalo.
\item
  Dizemos que um ponto \(c\) é um valor mínimo relativo de \(f(x)\) se
  existir um intervalo aberto contendo \(c\), no qual f(x) esteja
  definida, tal que f(𝑐) ≤ f(x) para todo x neste intervalo. (maximo e
  minimo dentro de um trecho de grafico)
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Figura 15. Ilustração de máximo/mínimo relativos.}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Multiplicando a função por -1 invertemos a sua concavidade.
\end{itemize}

\hypertarget{pontos-extremos-pico-do-morro-ou-fundo-do-vale}{%
\subsection{Pontos extremos (pico do morro ou fundo do
vale)}\label{pontos-extremos-pico-do-morro-ou-fundo-do-vale}}

\begin{itemize}
\tightlist
\item
  Se f(x) existe para todos os valores de x no intervalo aberto (𝑎,𝑏), e
  se f(x) tem um extremo relativo em 𝑐, em que 𝑎 \textless{} 𝑐
  \textless{} 𝑏, então f′(𝑐) existe e f′(𝑐) = 0.
\item
  Implicação - Sendo f(x) diferenciável os pontos extremos de f(x) vão
  ocorrer quando f′(x) = 0.
\item
  \(f'(x)\) pode ser igual a zero mesmo não sendo um extremo relativo.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Figura 16. Ilustração de uma função onde derivada zero não é ponto extremo.}
\end{Highlighting}
\end{Shaded}

\hypertarget{muxe1ximos-e-muxednimos-1}{%
\subsection{Máximos e mínimos}\label{muxe1ximos-e-muxednimos-1}}

Seja \(c\) um ponto extremo de uma função \(f(x)\) no qual
\(f'(c) = 0\), e suponha que \(f'(x)\) exista para todos os valores de x
em um intervalo aberto contendo 𝑐. Se f′′(𝑐) existe, então - Se f′′(𝑐)
\textless{} 0, então f(x) tem um máximo relativo em 𝑐. - Se f′′(𝑐)
\textgreater{} 0, então f(x) tem um mínimo relativo em 𝑐. \#\#
Concavidade - Se f′′(𝑐) \textgreater{} 0 o gráfico de f(x) é côncavo
para cima em (𝑐, f(𝑐)); - Se f′′(𝑐) \textless{} 0 o gráfico de f(x) é
côncavo para baixo em (𝑐, f(𝑐)).

Por que derivadas são importantes? - Obtenção de máximo ou mínino
(relativo).

ponto extremo tem inclinação zero (a3 na figura)

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Figura 17. Ilustração de uma função com a reta tangente.}
\end{Highlighting}
\end{Shaded}

\hypertarget{reduuxe7uxe3o-de-dados}{%
\subsection{Redução de dados}\label{reduuxe7uxe3o-de-dados}}

Você já trabalha com dados? Se sim, - Por qual razão você usa a média ou
a mediana como uma medida resumo? - Você acha que existe algum
procedimento mais geral que leva a obtenção destas medidas resumo? - Se
sim, como este procedimento está relacionado com o que vimos em relação
a funções e seu comportamento?

\begin{itemize}
\tightlist
\item
  Suponha que temos um conjunto de observações \(y_{i}\) para
  \(i = 1, … , n\).
\item
  Objetivo: resumir a informação contida em \(y_{i}\) em um único
  número, digamos \(\mu\).
\item
  Problema: como encontrar \(\mu\)?
\item
  Solução: encontrar o valor \(\mu\), tal que \$f(\mu) =
  \sum\emph{\{i=1\}\^{}\{n\} (y}\{i\} - \mu)\^{}2 \$ (soma de quadrados
  da diferença de cada valor para media, ou seja o quanto eu perdi ao
  trocar os \(y\) por \(\mu\)), seja a menor possível.
\item
  Uma vez que temos os números observados \(y_{i}\) a única quantidade
  desconhecida é\(\mu\).
\item
  Note que \(\mu\) é o parâmetro da nossa função.
\item
  A função \(f(\mu)\) mede o quanto perdemos em representar \(y_{i}\)
  apenas usando \(\mu\).
\item
  Funções perda muito populares são a perda quadrática, perda absoluta,
  minmax e a cross entropia.
\item
  dervar e igualar a 0.
\end{itemize}

Funções em R.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{8}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{14}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{15}\NormalTok{,}\DecValTok{11}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{13}\NormalTok{)}
\NormalTok{fmu }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(mu, y) \{}
\NormalTok{out }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{((y }\SpecialCharTok{{-}}\NormalTok{ mu)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\FunctionTok{return}\NormalTok{(out)}
\NormalTok{\}}
\NormalTok{fmu }\OtherTok{\textless{}{-}} \FunctionTok{Vectorize}\NormalTok{(fmu, }\StringTok{"mu"}\NormalTok{)}
\FunctionTok{fmu}\NormalTok{(}\AttributeTok{mu =} \FunctionTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{8}\NormalTok{), }\AttributeTok{y =}\NormalTok{ y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  117  161 1097  153
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [1] 117 161}
\NormalTok{f\_prime }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(mu, y) \{}
\NormalTok{out }\OtherTok{\textless{}{-}} \SpecialCharTok{{-}}\DecValTok{2}\SpecialCharTok{*}\FunctionTok{sum}\NormalTok{(y}\SpecialCharTok{{-}}\NormalTok{mu)}
\FunctionTok{return}\NormalTok{(out)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Graficamente

\begin{itemize}
\item
  Note que o melhor resumo dos dados de um número, corresponde ao ponto
  de mínimo da função \[
  f(y) = \sum_{i=1}^{n} (y_{i} -\mu )^2
  \]
\item
  Como o mínimo está relacionado com a derivada de \(f(\mu)\)?
\end{itemize}

\hypertarget{exemplo-reduuxe7uxe3o-de-dados}{%
\subsection{Exemplo: redução de
dados}\label{exemplo-reduuxe7uxe3o-de-dados}}

\begin{itemize}
\tightlist
\item
  No ponto de mínimo/máximo a inclinação da reta tangente a \(f(\mu)\) é
  zero.
\item
  Denote por 𝜇̂ o ponto de mínimo/máximo de 𝑓(𝜇), então 𝑓′(𝜇)̂ = 0.
\item
  Assim, temos (regra da cadeia!!)
\end{itemize}

\[ f(y) = \sum_{i=1}^{n} (y_{i} -\mu )^2\]
\[\varepsilon_{i} = y_{i} -\mu\]
\[  f'(\mu) = \sum_{i=1}^{n} (\varepsilon_{i})^2 \]
\[  f'(\mu) = 2 \sum_{i=1}^{n} (y_{i} -\mu) \frac{d}{d \mu} (y_{i} -\mu) \]

\[ f'(\mu) = 2 \sum_{i=1}^{n} (y_{i} -\mu) (-1)\]

\[ f'(\mu) = -2 \sum_{i=1}^{n} (y_{i} -\mu)\]

Exemplo: redução de dados - Agora precisamos achar o ponto 𝜇̂ tal que
𝑓′(𝜇)̂ = 0.

\[ f'(\mu_{chapeu}) = 0\]

\[  -2 \sum_{i=1}^{n} (y_{i} -\mu_{chapeu}) = 0\]
\[  -\sum_{i=1}^{n} (y_{i} -n \mu_{chapeu}) = 0\]
\[ n\mu_{chapeu} = \sum_{i=1}^{n} y_{i}\]

\[ \mu_{chapeu} = \frac{\sum_{i=1}^{n} y_{i}}{n}\] OU SEJA MÉDIA!!!

Comentários - Por qual razão você usa a média ou a mediana como uma
medida resumo? - Minimiza a perda quadrática. - Medida ótima no sentido
de perda quadrática. - Você acha que existe algum procedimento mais
geral que leva a obtenção destas medidas resumo? - Especificação do
modelo. - Escolha da função perda. - Treinamento (otimização). - Se sim,
como este procedimento está relacionado com o que vimos em relação a
funções e seu comportamento? - Estudar o comportamento de funções.

\hypertarget{derivadas-parciais}{%
\subsection{Derivadas parciais}\label{derivadas-parciais}}

\begin{itemize}
\tightlist
\item
  Uma função pode ter mais do que uma variável independente.
\item
  A derivada parcial mede a taxa de variação instantânea da variável
  dependente (𝑦) com relação a variável independente 𝑥1, quando a outra
  variável independente 𝑥2 é mantida constante.
\item
  Como obter a derivada parcial?
\item
  A derivada parcial em relação a 𝑥1 é obtida derivando 𝑓(𝑥1, 𝑥2)
  ``fingindo'' que 𝑥2 é uma constante.
\item
  A derivada parcial de 𝑓(𝑥1, 𝑥2) em relação a 𝑥2 é obtida derivando
  𝑓(𝑥1, 𝑥2) mantendo 𝑥1 constante.
\item
  A diferenciação parcial segue as mesmas regras da diferenciação
  ordinária.
\end{itemize}

Exemplo Obtenha as derivadas parciais em relação a \(x_{1}\) e \(x_{2}\)
de \(y = 5 x_{1}^{3} + 3 x_{1} x_{2} + 4 x_{2}^{2}\)

\[\displaystyle \frac{\partial y}{\partial x_{1}} = 15 x_{1}^{2} + 3 x_{2}\]
ou

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{D}\NormalTok{(}\FunctionTok{expression}\NormalTok{( }\DecValTok{5} \SpecialCharTok{*}\NormalTok{ x}\SpecialCharTok{\^{}}\DecValTok{3} \SpecialCharTok{+} \DecValTok{3} \SpecialCharTok{*}\NormalTok{ x }\SpecialCharTok{*}\NormalTok{ c }\SpecialCharTok{+} \DecValTok{4}\SpecialCharTok{*}\NormalTok{ c}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{ ), }\AttributeTok{name =} \StringTok{"x"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 5 * (3 * x^2) + 3 * c
\end{verbatim}

\[\displaystyle \frac{\partial y}{\partial x_{2}} = 3 x_{1} + 8 x_{2}\]

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{D}\NormalTok{(}\FunctionTok{expression}\NormalTok{( }\DecValTok{5} \SpecialCharTok{*}\NormalTok{ x}\SpecialCharTok{\^{}}\DecValTok{3} \SpecialCharTok{+} \DecValTok{3} \SpecialCharTok{*}\NormalTok{ x }\SpecialCharTok{*}\NormalTok{ c }\SpecialCharTok{+} \DecValTok{4}\SpecialCharTok{*}\NormalTok{ c}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{ ), }\AttributeTok{name =} \StringTok{"c"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 3 * x + 4 * (2 * c)
\end{verbatim}

Derivadas parciais de ordem superior - Derivadas parciais de segunda
ordem 𝜕2𝑓(𝑥1,𝑥2) 𝜕𝑥21 e 𝜕2𝑓(𝑥1,𝑥2) 𝜕𝑥22 indica que a função foi
diferenciada parcialmente em relação a 𝑥1 ou 𝑥2 duas vezes. - Derivada
parcial cruzada (ou mista) 𝜕2𝑓(𝑥1,𝑥2) 𝜕𝑥1𝜕𝑥2 indica que primeiro
derivamos em 𝑥1 e depois em 𝑥2. - A ordem da derivada cruzada não
importa (se ambas contínuas), ou seja 𝜕2𝑓(𝑥1,𝑥2) 𝜕𝑥1𝜕𝑥2 = 𝜕2𝑓(𝑥1,𝑥2)
𝜕𝑥2𝜕𝑥1 .

Exemplo: derivadas parciais de segunda ordem - Obtenha as derivadas
parciais de até segunda ordem em relação a 𝑥1 e 𝑥2 de 𝑦 = 7𝑥31 + 9𝑥1𝑥2 +
2𝑥52 . - Derivadas parciais de primeira ordem 𝜕𝑦 𝜕𝑥1 = 21𝑥21 + 9𝑥2, 𝜕𝑦
𝜕𝑥2 = 9𝑥1 + 10𝑥42 . - Derivadas parciais de segunda ordem (segunda
derivadas direta) 𝜕2𝑦 𝜕𝑥21 = 42𝑥1, 𝜕2𝑦 𝜕𝑥22 = 40𝑥32 . - Derivadas
parciais de segunda ordem (termos cruzados) 𝜕2𝑦 𝜕𝑥1𝑥2 = 𝜕21𝑥21 + 9𝑥2 𝜕𝑥2
= 9, 𝜕2𝑦 𝜕𝑥2𝑥1 = 𝜕9𝑥1 + 10𝑥42 𝜕𝑥1 = 9.

\begin{itemize}
\tightlist
\item
  As cruzadas dão sempre iguais.
\end{itemize}

\hypertarget{muxe1ximos-e-muxednimos-funuxe7uxf5es-muldimensionais}{%
\subsection{Máximos e mínimos funções
muldimensionais}\label{muxe1ximos-e-muxednimos-funuxe7uxf5es-muldimensionais}}

\begin{itemize}
\tightlist
\item
  Pontos críticos: as derivadas parciais de primeira ordem devem ser
  iguais a zero \textbf{simultaneamente}.
\item
  Derivadas parciais \textbf{principais} de segunda ordem no ponto
  crítico forem ambas \textbf{positivas -\textgreater{} ponto de
  mínimo}.
\item
  Derivadas parciais de segunda ordem no ponto crítico forem ambas
  \textbf{negativas -\textgreater{} ponto de máximo}.
\item
  Outras situações ver material suplementar.
\end{itemize}

\hypertarget{exemplo-1}{%
\subsection{Exemplo}\label{exemplo-1}}

Considere a função 𝑦 = 6𝑥21 − 9𝑥1 − 3𝑥1𝑥2 − 7𝑥2 + 5𝑥22 . Encontre os
pontos críticos e determine se são de máximo ou minímo. - Graficamente

\begin{itemize}
\item
  Calcular as derivadas parciais de primeira ordem da função 𝑦 = 6𝑥21 −
  9𝑥1 − 3𝑥1𝑥2 − 7𝑥2 + 5𝑥22 .
\item
  Derivando em 𝑥1, temos 𝜕𝑦 𝜕𝑥1 = 12𝑥1 − 9 − 3𝑥2.
\item
  Derivando em 𝑥2, temos 𝜕𝑦 𝜕𝑥2 = −3𝑥1 − 7 + 10𝑥2.
\item
  Resolver o sistema de equações 12𝑥1 − 9 − 3𝑥2 = 0 −3𝑥1 − 7 + 10𝑥2 = 0.
\item
  Solução: 𝑥1 = 1 e 𝑥2 = 1. \#\# USA NA PROXIMA
\item
  Verificar se o ponto encontrado é de mínimo calculando a segunda
  derivada parcial principal e avaliando o seu sinal.
\end{itemize}

𝜕2𝑦 𝜕𝑥21 = 𝜕 𝜕𝑥1 (12𝑥1 − 9 − 3𝑥2) = 12, 𝜕2𝑦 𝜕𝑥22 = 𝜕 𝜕𝑥2 (3𝑥1 − 7 +
10𝑥2) = 10.

\begin{itemize}
\tightlist
\item
  Calcular as derivadas cruzadas e verificar se o produto das derivadas
  principais é maior que o produto das cruzadas
\end{itemize}

𝜕2𝑦 𝜕𝑥1𝑥2 = 𝜕12𝑥1 − 9 − 3𝑥2 𝜕𝑥2 = −3, 𝜕2𝑦 𝜕𝑥2𝑥1 = 𝜕 − 3𝑥1 − 7 + 10𝑥2 𝜕𝑥2
= −3.

Assim, temos que 𝜕2𝑦 𝜕𝑥21 𝜕2𝑦 𝜕𝑥22 ( 𝜕2𝑦 𝜕𝑥1𝑥2 ) 2 12 ⋅ 10
\textgreater{} (−3)2 120 \textgreater{} 9.

\begin{itemize}
\tightlist
\item
  A função está em um ponto de mínimo quando examinada de todas as
  direções.
\end{itemize}

\hypertarget{gradiente-e-hessiano}{%
\subsection{Gradiente e Hessiano}\label{gradiente-e-hessiano}}

\hypertarget{gradiente}{%
\subsection{Gradiente}\label{gradiente}}

\begin{itemize}
\tightlist
\item
  Derivadas de primeira e segunda ordem aparecem com tanta frequência
  que receberam nomes especiais.
\item
  O vetor gradiente de uma função 𝑓(𝑥1,𝑥2) é o \textbf{vetor composto
  pelas derivadas primeira} de 𝑓(𝑥1,𝑥2) em relação a 𝑥1 e 𝑥2, ∇𝑓(𝑥1,𝑥2)
  = ( 𝜕𝑓(𝑥1,𝑥2) 𝜕𝑥1 , 𝜕𝑓(𝑥1,𝑥2) 𝜕𝑥2 ) ⊤ .
\item
  A definição estende-se naturalmente para funções multidimensionais.
\item
  Sendo, 𝑓(𝑥) onde 𝑥 é um vetor 𝑝 × 1 de variáveis independentes o vetor
  gradiente de 𝑓(𝑥) é dado por ∇𝑓(𝑥) = ( 𝜕𝑓(𝑥) 𝜕𝑥1 , \ldots{} , 𝜕𝑓(𝑥)
  𝜕𝑥𝑝 ) ⊤ .
\end{itemize}

\hypertarget{hessiano}{%
\subsection{Hessiano}\label{hessiano}}

\begin{itemize}
\tightlist
\item
  A matriz hessiana de uma função 𝑓(𝑥1,𝑥2) é a matriz composta pelas
  \textbf{derivadas de segunda ordem} de 𝑓(𝑥1,𝑥2), na seguinte estrutura
  H = ( 𝜕2𝑓(𝑥1,𝑥2) 𝜕𝑥21 𝜕𝑓(𝑥1,𝑥2) 𝜕𝑥1𝜕𝑥2 𝜕𝑓(𝑥1,𝑥2) 𝜕𝑥2𝜕𝑥1 𝜕2𝑓(𝑥1,𝑥2)
  𝜕𝑥22 ) .
\item
  E para o caso multidimensional H = ⎛⎜⎜⎜ ⎝ 𝜕2𝑓(𝑥) 𝜕𝑥21 ⋯ 𝜕𝑓(𝑥) 𝜕𝑥1𝜕𝑥𝑝 ⋮
  ⋱ ⋮ 𝜕𝑓(𝑥) 𝜕𝑥𝑝𝜕𝑥1 ⋯ 𝜕2𝑓(𝑥) 𝜕𝑥2 𝑝 ⎞⎟⎟⎟ ⎠
\end{itemize}

\hypertarget{suxe9ries-de-taylor}{%
\subsection{Séries de Taylor}\label{suxe9ries-de-taylor}}

\begin{itemize}
\tightlist
\item
  Suponha que uma função 𝑓(𝑥) é derivável (𝑛 + 1) vezes em um intervalo
  contendo 𝑥 = 𝑥0.
\item
  Expansão em Série de Taylor de 𝑓(𝑥) em torno de 𝑥 = 𝑥0 consiste em
  reescrever 𝑓(𝑥) da seguinte forma: 𝑓(𝑥) = 𝑓(𝑥0) + (𝑥 − 𝑥0) 𝑑𝑓(𝑥) 𝑑𝑥
  \textbar 𝑥=𝑥0 + (𝑥 − 𝑥0)2 2! 𝑑2𝑓(𝑥) 𝑑𝑥2 \textbar 𝑥=𝑥0+ (2) (𝑥 − 𝑥0)3
  3! 𝑑3𝑓(𝑥) 𝑑𝑥3 \textbar 𝑥=𝑥0 + \ldots{} + (𝑥 − 𝑥0)𝑛 𝑛! 𝑑𝑛𝑓(𝑥) 𝑑𝑥𝑛
  \textbar 𝑥=𝑥0 + 𝑅𝑛(𝑥) (3) onde o termo 𝑅𝑛(𝑥) é chamado de resíduo ou
  erro, e dado por 𝑅𝑛(𝑥) = (𝑥 − 𝑥0)𝑛+1 (𝑛 + 1)! 𝑑𝑛+1𝑓(𝑥) 𝑑𝑥𝑛+1
  \textbar 𝑥=𝜖 sendo 𝜖 um valor entre 𝑥 e 𝑥0.
\end{itemize}

\hypertarget{exemplo-2}{%
\subsection{Exemplo}\label{exemplo-2}}

\begin{itemize}
\tightlist
\item
  Seja 𝑓(𝑥) = exp(𝑥). Determine a expansão de Taylor de ordens 1 e 2, de
  𝑓(𝑥) ao redor de 𝑥0 = 0.
\item
  Aproximação de primeira ordem 𝑃1(𝑥) = 𝑓(𝑥 = 0) + 𝑓′(𝑥 = 0)(𝑥 − 0) =
  exp(0) + exp(0)(𝑥 − 0) = 1 + 𝑥.
\item
  Aproximação de segunda ordem 𝑃2(𝑥) = 𝑓(𝑥 = 0) + 𝑓′(𝑥 = 0)(𝑥 − 0) +
  𝑓′′(𝑥 = 0) 2 (𝑥 − 0)2 = exp(0) + exp(0)(𝑥 − 0) + exp(0) 2 (𝑥 − 0)2 = 1
  + 𝑥 + 1 2 𝑥2.
\end{itemize}

Graficos

\begin{itemize}
\tightlist
\item
  Quanto mais se afasta de zero pior fica a aproximação.
\item
  A Tailor em n+1 graus é igual a original
\end{itemize}

\hypertarget{regressuxe3o-linear-simples}{%
\subsection{Regressão linear
simples}\label{regressuxe3o-linear-simples}}

\begin{itemize}
\tightlist
\item
  Regressão linear é uma das técnicas mais populares em ciência de
  dados.
\item
  Objetivo: descrever o comportamento de uma variável dependente 𝑦 por
  meio do conhecimento de outra variável independente 𝑥.
\item
  Predizer 𝑦 dado um valor de 𝑥.
\item
  Descrever a relação entre 𝑦 e 𝑥.
\item
  Exemplo

  \begin{itemize}
  \tightlist
  \item
    Como o tamanho (em metros quadrados) de um apartamento está
    associado ao seu preço (em reais)?
  \item
    Suponha que um conjunto de 20 apartamentos foi medido e avaliado.
  \end{itemize}
\end{itemize}

Grafico

Regressão linear simples - Ideia simples! → O preço deve ser uma função
do tamanho do apartamento. - Formalização matemática: - Denote por 𝑦𝑖
para 𝑖 = 1, \ldots{} ,𝑛 o preço do apartamento 𝑖 e neste caso 𝑛 = 20. -
Denote por 𝑥𝑖 o tamanho do apartamento 𝑖 em metros quadrados. - Função
relacionando preço ∼ tamanho \[ Preço = f(metroquadrado) \]
\[ y_{i} = f^{*}(x_{i})\]

\begin{itemize}
\item
  Qual é a função 𝑓∗(𝑥𝑖)?
\item
  Não conhecemos e em geral nunca vamor conhecer 𝑓∗(𝑥𝑖).
\item
  Aproximar 𝑓∗(𝑥𝑖) por outra função 𝑓(𝑥𝑖) conhecida.
\item
  Problema: qual 𝑓(𝑥𝑖) e como fazer a aproximação!
\item
  Uma opção é usar a expansão em série de Taylor para obter uma
  aproximação.
\item
  Aproximação em série de Taylor de primeira ordem
  \[ f^{*}(x) = f^{*}(x_0) + (x - x_0)f^{*'}(x) + R_n(x)\]
\item
  Ignorando o termo residual 𝑅𝑛(𝑥) 𝑓∗(𝑥) ≈ 𝑓∗(𝑥0) + (𝑥 − 𝑥0)𝑓∗′(𝑥0).
\item
  Rearranjando os termos obtemos 𝑓∗(𝑥) ≈ ⏟\{𝑓⏟∗(⏟𝑥0⏟)⏟− 𝑓∗⏟′(𝑥⏟0⏟)𝑥⏟0\}
  𝛽0
\item
  𝑓⏟∗′(𝑥0) 𝛽1 𝑥 𝑓∗(𝑥) ≈ 𝛽0 + 𝛽1𝑥.
\item
  De forma equivalente, temos 𝑦𝑖 = 𝛽0 + 𝛽1𝑥𝑖 + 𝑅𝑛(𝑥𝑖), em que o termo
  𝑅𝑛(𝑥𝑖) é o erro cometido em aproximar 𝑦𝑖 por 𝛽0 + 𝛽1𝑥𝑖.
\item
  Notação usual 𝜖𝑖 = 𝑦𝑖 − (𝛽0 + 𝛽1𝑥𝑖).
\item
  Note que o erro é uma função dos parâmetros desconhecidos 𝛽0 e 𝛽1.
\item
  Objetivo: minimizar a soma de quadrados dos erros ou resíduos \[ 
  \]
\end{itemize}

𝑆𝑄(𝛽0, 𝛽1) = 𝑛Σ 𝑖=1 𝜖2(𝛽0, 𝛽1)𝑖 𝑆𝑄(𝛽0, 𝛽1) = 𝑛Σ 𝑖=1 (𝑦𝑖 − (𝛽0 + 𝛽1𝑥𝑖))2.

\begin{itemize}
\tightlist
\item
  Obter o vetor gradiente ∇𝑆𝑄(𝛽0,𝛽1) = ( 𝜕𝑆𝑄(𝛽0,𝛽1) 𝜕𝛽0 , 𝜕𝑆𝑄(𝛽0, 𝛽1)
  𝜕𝛽1 ) .
\item
  Encontrar 𝛽0̂ e 𝛽1̂ tal que ∇𝑆𝑄(𝛽0̂ ,𝛽1̂ ) = 0.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Chame 𝑦𝑖 − (𝛽0 + 𝛽1𝑥𝑖) = 𝜖𝑖.
\item
  Chame 𝛽0 + 𝛽1𝑥𝑖 = 𝜇𝑖.
\item
  Assim, ∇𝑆𝑄(𝛽0,𝛽1) = ( 𝜕𝑆𝑄(𝛽0,𝛽1) 𝜕𝜖𝑖 𝜕𝜖𝑖 𝜇𝑖 𝜕𝜇𝑖 𝜕𝛽0 , 𝜕𝑆𝑄(𝛽0,𝛽1) 𝜕𝜖𝑖
  𝜕𝜖𝑖 𝜇𝑖 𝜕𝜇𝑖 𝜕𝛽1 ) , em que 𝜕𝑆𝑄(𝛽0,𝛽1) 𝜕𝜖𝑖 = 𝜕 𝜕𝜖𝑖 𝑛Σ 𝑖=1 𝜖2 𝑖 = 2 𝑛Σ
  𝑖=1 𝜖𝑖. 𝜕𝜖𝑖 𝜕𝜇𝑖 = 𝜕 𝜕𝜇𝑖 (𝑦𝑖 − 𝜇𝑖) = −1, 𝜕𝜇𝑖 𝜕𝛽0 = 𝜕 𝜕𝛽0 𝛽0 + 𝛽1𝑥𝑖 = 1,
  𝜕𝜇𝑖 𝜕𝛽1 = 𝜕 𝜕𝛽1 𝛽0 + 𝛽1𝑥𝑖 = 𝑥𝑖.
\end{enumerate}

Vetor gradiente - Portanto, ∇𝑆𝑄(𝛽0,𝛽1) = (−2 𝑛Σ 𝑖=1 𝜖𝑖(1); −2 𝑛Σ 𝑖=1
𝜖𝑖𝑥𝑖) = (−2 𝑛Σ 𝑖=1 (𝑦𝑖 − 𝛽0 − 𝛽1𝑥𝑖); −2 𝑛Σ 𝑖=1 (𝑦𝑖 − 𝛽0 − 𝛽1𝑥𝑖)𝑥𝑖) . -
Resolver o sistema de equações simultâneas (derivadas de beta 0 e beta
1) −2 𝑛Σ 𝑖=1 (𝑦𝑖 − 𝛽0̂ − 𝛽1̂ 𝑥𝑖) = 0 −2 𝑛Σ 𝑖=1 (𝑦𝑖 − 𝛽0̂ − 𝛽1̂ 𝑥𝑖)𝑥𝑖 = 0.

\begin{itemize}
\tightlist
\item
  Solução 𝛽0̂ = 𝑦̄− 𝛽1̂ 𝑥,̄ 𝛽1̂ = Σ𝑛 𝑖=1 𝑦𝑖𝑥𝑖 − 𝑦̄Σ𝑛 𝑖=1 𝑥𝑖 Σ𝑛 𝑖=1 𝑥2 𝑖 − 𝑥̄Σ𝑛
  𝑖=1 𝑥𝑖
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Carregando a base de dados}
\NormalTok{dados }\OtherTok{\textless{}{-}} \FunctionTok{read.table}\NormalTok{(}\StringTok{"Data\_files/reglinear.csv"}\NormalTok{,}
                    \AttributeTok{header =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{dados}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           y  x
## 1  207317.7 55
## 2  250845.7 69
## 3  165755.0 46
## 4  219816.7 61
## 5  268582.2 73
## 6  229059.7 63
## 7  179098.1 50
## 8  168301.8 46
## 9  250917.7 69
## 10 230990.3 62
## 11 229818.7 63
## 12 221484.1 60
## 13 187977.0 55
## 14 251526.9 70
## 15 242289.5 66
## 16 211007.7 59
## 17 197455.5 53
## 18 192100.8 51
## 19 208762.3 57
## 20 204593.1 54
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Obtendo beta1}
\NormalTok{beta1 }\OtherTok{\textless{}{-}}\NormalTok{ (}\FunctionTok{sum}\NormalTok{(dados}\SpecialCharTok{$}\NormalTok{y}\SpecialCharTok{*}\NormalTok{dados}\SpecialCharTok{$}\NormalTok{x) }\SpecialCharTok{{-}}
            \FunctionTok{mean}\NormalTok{(dados}\SpecialCharTok{$}\NormalTok{y)}\SpecialCharTok{*}\FunctionTok{sum}\NormalTok{(dados}\SpecialCharTok{$}\NormalTok{x))}\SpecialCharTok{/}
\NormalTok{  (}\FunctionTok{sum}\NormalTok{(dados}\SpecialCharTok{$}\NormalTok{x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(dados}\SpecialCharTok{$}\NormalTok{x)}\SpecialCharTok{*}\FunctionTok{sum}\NormalTok{(dados}\SpecialCharTok{$}\NormalTok{x))}
\CommentTok{\# Obtendo beta0}
\NormalTok{beta0 }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(dados}\SpecialCharTok{$}\NormalTok{y) }\SpecialCharTok{{-}}\NormalTok{ beta1}\SpecialCharTok{*}\FunctionTok{mean}\NormalTok{(dados}\SpecialCharTok{$}\NormalTok{x)}
\FunctionTok{c}\NormalTok{(beta0, beta1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2622.752 3608.499
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [1] 2622.752 3608.499}
\DocumentationTok{\#\# Verificando}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{coef}\NormalTok{(}\FunctionTok{lm}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x, }\AttributeTok{data =}\NormalTok{ dados))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## (Intercept)           x 
##    2622.752    3608.499
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# (Intercept) x}
\DocumentationTok{\#\# 2622.752 3608.499}
\end{Highlighting}
\end{Shaded}

Modelo: ychapeu = 2622.752 + 3608.499* metrosquadrados

\hypertarget{discussuxe3o}{%
\subsection{Discussão}\label{discussuxe3o}}

\begin{itemize}
\tightlist
\item
  Derivadas são essenciais em estatística.
\item
  Maximizar/minimizar funções perda/objetivo.
\item
  O cálculo é por vezes difícil e tedioso.
\item
  Solução de sistemas lineares é tedioso quando possível.
\item
  Álgebra linear ajuda a generalizar as soluções.
\item
  Em situações mais gerais expressões analíticas não serão possíveis de
  obter.
\item
  Métodos numéricos para resolução de sistemas lineares.
\item
  Métodos numéricos para resolução de sistemas não-lineares.
\item
  Métodos de otimização numérica.
\end{itemize}

\hypertarget{aula-2024-04-06}{%
\section{Aula 2024-04-06}\label{aula-2024-04-06}}

\hypertarget{integrais}{%
\subsection{Integrais}\label{integrais}}

Anti-derivada

\hypertarget{integral-indefinida}{%
\subsubsection{Integral indefinida}\label{integral-indefinida}}

\begin{itemize}
\tightlist
\item
  Chamamos de integral indefinida o oposto ou o inverso da derivada,
  também chamada de antiderivada.
\item
  A integral indefinida da função \(f(x)\) é expressa por \[
  ∫ 𝑓(𝑥)𝑑𝑥 = 𝐹 (𝑥) + 𝑐.
  \]
\item
  Exemplo, \[ 
  ∫ 𝑥𝑑𝑥 = 𝑥2
  \] 2 + 𝑐, uma vez que se derivarmos 𝑥2 2 encontramos 𝑥
\end{itemize}

{[}\ldots{]}

\hypertarget{soma-de-riemann}{%
\subsubsection{Soma de Riemann}\label{soma-de-riemann}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{soma\_riemann }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(n, a, b, fx, ...) \{}
\NormalTok{  intervalos }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(a, b, }\AttributeTok{length =}\NormalTok{ n)}
\NormalTok{  ci }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}
\NormalTok{  soma }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{c}\NormalTok{(n}\DecValTok{{-}1}\NormalTok{)) \{}
\NormalTok{    Deltai }\OtherTok{\textless{}{-}}\NormalTok{ (intervalos[i}\SpecialCharTok{+}\DecValTok{1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ intervalos[i]) }\CommentTok{\# Tamanho do intervalo}
\NormalTok{    ci[i] }\OtherTok{\textless{}{-}}\NormalTok{ (intervalos[i}\SpecialCharTok{+}\DecValTok{1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ intervalos[i])}\SpecialCharTok{/}\DecValTok{2} \CommentTok{\# Ponto central do intervalo}
\NormalTok{    soma[i] }\OtherTok{\textless{}{-}} \FunctionTok{fx}\NormalTok{(ci[i])}\SpecialCharTok{*}\NormalTok{Deltai }\CommentTok{\# Cada elemento da soma}
\NormalTok{  \}}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{sum}\NormalTok{(soma))}
\NormalTok{\}}
\NormalTok{soma\_riemann }\OtherTok{\textless{}{-}} \FunctionTok{Vectorize}\NormalTok{(soma\_riemann, }\StringTok{"n"}\NormalTok{)}

\FunctionTok{soma\_riemann}\NormalTok{(}\AttributeTok{n =} \DecValTok{2}\NormalTok{, }\AttributeTok{a =} \DecValTok{1}\NormalTok{, }\AttributeTok{b =} \DecValTok{2}\NormalTok{, }\AttributeTok{fx =} \ControlFlowTok{function}\NormalTok{(x) x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2.25
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{soma\_riemann}\NormalTok{(}\AttributeTok{n =} \DecValTok{10}\NormalTok{, }\AttributeTok{a =} \DecValTok{1}\NormalTok{, }\AttributeTok{b =} \DecValTok{2}\NormalTok{, }\AttributeTok{fx =} \ControlFlowTok{function}\NormalTok{(x) x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2.332305
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{soma\_riemann}\NormalTok{(}\AttributeTok{n =} \DecValTok{50}\NormalTok{, }\AttributeTok{a =} \DecValTok{1}\NormalTok{, }\AttributeTok{b =} \DecValTok{2}\NormalTok{, }\AttributeTok{fx =} \ControlFlowTok{function}\NormalTok{(x) x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2.333299
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{soma\_riemann}\NormalTok{(}\AttributeTok{n =} \DecValTok{100}\NormalTok{, }\AttributeTok{a =} \DecValTok{1}\NormalTok{, }\AttributeTok{b =} \DecValTok{2}\NormalTok{, }\AttributeTok{fx =} \ControlFlowTok{function}\NormalTok{(x) x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2.333325
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{soma\_riemann}\NormalTok{(}\AttributeTok{n =} \DecValTok{1000}\NormalTok{, }\AttributeTok{a =} \DecValTok{1}\NormalTok{, }\AttributeTok{b =} \DecValTok{2}\NormalTok{, }\AttributeTok{fx =} \ControlFlowTok{function}\NormalTok{(x) x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2.333333
\end{verbatim}

\hypertarget{integrauxe7uxe3o-numuxe9rica-em-r}{%
\subsubsection{Integração numérica em
R}\label{integrauxe7uxe3o-numuxe9rica-em-r}}

\begin{itemize}
\tightlist
\item
  O R tem uma função nativa para o cálculo de integrais ?integrate.
\item
  Exemplo:
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fx }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) x}\SpecialCharTok{\^{}}\DecValTok{2}
\FunctionTok{integrate}\NormalTok{(fx, }\AttributeTok{lower =} \DecValTok{1}\NormalTok{, }\AttributeTok{upper =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 2.333333 with absolute error < 2.6e-14
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# 2.333333 with absolute error \textless{} 2.6e{-}14}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Outros tipos de integrais

  \begin{itemize}
  \tightlist
  \item
    Integrais multidimensionais.
  \item
    Integrais impróprias.
  \end{itemize}
\end{itemize}

\hypertarget{discussuxe3o-1}{%
\subsubsection{Discussão}\label{discussuxe3o-1}}

\begin{itemize}
\tightlist
\item
  Integrais são extremamente úteis para obter alguns resultados teóricos
  em probabilidade.
\item
  Permitem o cálculo de probabilidades para variáveis aleatórias
  contínuas.
\item
  Técnicas (básicas) de modelagem estatística e machine learning não
  usam integrais diretamente.
\item
  Em geral integrais são mais difíceis de calcular do que derivadas.
\item
  É possível estender a ideia de integrais para funções com duas ou mais
  variáveis de forma análoga feita para derivadas.
\item
  Integrais em alta dimensão são extremamente difíceis de calcular e/ou
  aproximar numéricamente.
\end{itemize}

\hypertarget{uxe1lgebra-matricial}{%
\section{Álgebra Matricial}\label{uxe1lgebra-matricial}}

\hypertarget{vetores-e-escalares}{%
\subsection{Vetores e escalares}\label{vetores-e-escalares}}

\begin{itemize}
\tightlist
\item
  Um vetor é uma lista de 𝑛 números (escalares) escritos em linha ou
  coluna.
\item
  Notação (primeiro a em negrito)
\end{itemize}

\[
a = (a_{i1} ... a_{in})
\] ou

\[
a = \begin{bmatrix}
a_{i1}\\
.\\
.\\
.\\
a_{in}\\
\end{bmatrix}
\]

\begin{itemize}
\tightlist
\item
  Vetor linha e vetor coluna.
\item
  Um elemento do vetor é chamado de 𝑎𝑖, sendo 𝑖 a sua posição.
\item
  O tamanho de um vetor é o seu número de elementos.
\item
  O módulo de um vetor é o seu comprimento \[
  |a| = \sqr𝑎2
  1 + … + 𝑎2
  𝑛.
  \]
\item
  Vetor unitário é aquele que tem tamanho \[
  a = a
  |a| .
  \]
\item
  Dois vetores são iguais se tem o mesmo tamanho e os seus elementos em
  posições equivalentes são iguais.
\end{itemize}

\hypertarget{operauxe7uxf5es-com-vetores}{%
\subsubsection{Operações com
vetores}\label{operauxe7uxf5es-com-vetores}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Soma \(a + b = (𝑎𝑖 + 𝑏𝑖) = (𝑎1 + 𝑏1, … , 𝑎𝑛 + 𝑏𝑛)\).
\end{enumerate}

\(a = (1, 2, 3)\) \(b = (3, 2, 1)\) \(a+b = (4, 4, 4)\)
\(a-b = (-2, 0, 2)\)

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Subtração \(a − b = (𝑎𝑖 − 𝑏𝑖) = (𝑎1 − 𝑏1, … , 𝑎𝑛 − 𝑏𝑛)\).
\end{enumerate}

\[
a-b = (-2, 0, 2)
\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Multiplicação por escalar \(𝛼a = (𝛼𝑎1, … , 𝛼𝑎𝑛)\).
\end{enumerate}

\[
5 * a = (5*1, 5*2, 5*3)
\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\item
  Transposta de um vetor: {[}\ldots{]}
\item
  Produto interno ou escalar entre dois vetores resulta em um escalar
  (mutiplica dois vetores e dá um número só como resultado) a ⋅ b =
  (𝑎1𝑏1 + 𝑎2𝑏2 + \ldots{} + 𝑎𝑛𝑏𝑛).
\end{enumerate}

\begin{itemize}
\tightlist
\item
  \textbf{Condições: os vetores devem ser do mesmo tipo e tamanho.}
\end{itemize}

\hypertarget{vetores-ortogonais}{%
\subsubsection{Vetores ortogonais}\label{vetores-ortogonais}}

\begin{itemize}
\item
  Dois vetores são ortogonais entre si se o ângulo 𝜃 entre eles é de
  90∘.(= correlação de Pearson)
\item
  Implicações: \[cos(𝜃) = 0 e a⊤b = 0.\]
  \[ cov (a,b) / raiz(variacia[a]) * raiz(variacia[b])\]
\item
  O co-seno do ângulo 𝜃 entre os vetores é dado por:
  \[cos(𝜃) = a⊤b / \sqra⊤a\sqrb⊤b .\]
\end{itemize}

\hypertarget{operauxe7uxf5es-com-vetores-em-r}{%
\subsubsection{Operações com vetores em
R}\label{operauxe7uxf5es-com-vetores-em-r}}

\begin{itemize}
\tightlist
\item
  Declarando vetores
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{)}
\NormalTok{b }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Sendo a e b compatíveis
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#\# Soma}
\NormalTok{a }\SpecialCharTok{+}\NormalTok{ b}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5 7 9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [1] 5 7 9}
\DocumentationTok{\#\#\#\# Substração}
\NormalTok{a }\SpecialCharTok{{-}}\NormalTok{ b}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3 3 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [1] 3 3 3}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Multiplicação por escalar
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{alpha }\OtherTok{=} \DecValTok{10}
\NormalTok{alpha}\SpecialCharTok{*}\NormalTok{a}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 40 50 60
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [1] 40 50 60}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Produto de Hadamard (não é produto interno)
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a}\SpecialCharTok{*}\NormalTok{b}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  4 10 18
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [1] 4 10 18}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Produto vetorial (ou produto interno)
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a}\SpecialCharTok{\%*\%}\NormalTok{b}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1]
## [1,]   32
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#    [,1]}
\DocumentationTok{\#\# [1,] 32}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Co-seno do ângulo entre dois vetores
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cos }\OtherTok{\textless{}{-}} \FunctionTok{t}\NormalTok{(a)}\SpecialCharTok{\%*\%}\NormalTok{b}\SpecialCharTok{/}\NormalTok{(}\FunctionTok{sqrt}\NormalTok{(}\FunctionTok{t}\NormalTok{(a)}\SpecialCharTok{\%*\%}\NormalTok{a)}\SpecialCharTok{*}\FunctionTok{sqrt}\NormalTok{(}\FunctionTok{t}\NormalTok{(b)}\SpecialCharTok{\%*\%}\NormalTok{b))}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Lei da reciclagem (não avalia se pode somar antes de somar)
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{7}\NormalTok{)}
\NormalTok{b }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{)}
\NormalTok{a }\SpecialCharTok{+}\NormalTok{ b}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  5  7  9  6  8 10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [1] 5 7 9 6 8 10}
\end{Highlighting}
\end{Shaded}

\hypertarget{matrizes}{%
\subsection{Matrizes}\label{matrizes}}

\begin{itemize}
\item
  Uma matriz é um arranjo retangular ou quadrado de números ou
  variáveis.
\item
  A matriz costuma ser representada por uma letra maiuscula em negrito
\item
  Uma matriz (𝑛 × 𝑚) tem 𝑛 linhas e 𝑚 colunas:
\end{itemize}

\[A = \begin{pmatrix}\
a_{11} & a_{12} & ... & a_{1m}\\
a_{21} & a_{22} & ... & a_{2m}\\
... & ... & ... & ... \\
a_{n1} & a_{11} & ... & a_{nm}\\
\end{pmatrix}\]

\begin{itemize}
\tightlist
\item
  O primeiro subscrito representa linha e o segundo representa coluna.
\item
  A dimensão de uma matriz é o seu número de linhas e colunas.
\item
  Duas matrizes são iguais se tem a mesma dimensão e se os elementos das
  correspondentes posições são iguais.
\end{itemize}

\hypertarget{matriz-transposta}{%
\subsubsection{Matriz transposta}\label{matriz-transposta}}

\begin{itemize}
\tightlist
\item
  A operação de transposição rearranja uma matriz de forma que suas
  linhas são transformadas em colunas e vice-versa. ⎛⎜ ⎝ 1 2 3 4 5 6 ⎞⎟
  ⎠ ⊤ = (1 3 5 2 4 6) .
\item
  Note que (A⊤)⊤ = A.
\item
  Computacionalmente
\item
  Declarando matrizes
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{)}
\NormalTok{A }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(a, }\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\NormalTok{A}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [,1] [,2]}
\DocumentationTok{\#\# [1,] 1 4}
\DocumentationTok{\#\# [2,] 2 5}
\DocumentationTok{\#\# [3,] 3 6}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  O default preenche por colunas.
\item
  Transposta de uma matriz
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t}\NormalTok{(A)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [,1] [,2] [,3]}
\DocumentationTok{\#\# [1,] 1 2 3}
\DocumentationTok{\#\# [2,] 4 5 6}
\end{Highlighting}
\end{Shaded}

\hypertarget{operauxe7uxf5es-com-matrizes}{%
\subsubsection{Operações com
matrizes}\label{operauxe7uxf5es-com-matrizes}}

\begin{itemize}
\item
  Multiplicação matriz por escalar. \[\alpha * A = \begin{pmatrix}\
  \alpha * a_{11} & \alpha * a_{12} & \alpha * ... & \alpha * a_{1m}\\
  \alpha * a_{21} & \alpha * a_{22} & \alpha * ... & \alpha * a_{2m}\\
  \alpha * ... & \alpha * ... & \alpha * ... & \alpha * ... \\
  \alpha * a_{n1} & \alpha * a_{n2} & \alpha * ... & \alpha * a_{nm}\\
  \end{pmatrix}\]
\item
  Computacionalmente
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{A }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{),}
\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\NormalTok{alpha }\OtherTok{\textless{}{-}} \DecValTok{10}
\NormalTok{alpha}\SpecialCharTok{*}\NormalTok{A}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]   10   40
## [2,]   20   50
## [3,]   30   60
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [,1] [,2]}
\DocumentationTok{\#\# [1,] 10 40}
\DocumentationTok{\#\# [2,] 20 50}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Duas matrizes podem ser somadas ou subtraídas somente se tiverem o
  mesmo tamanho.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Soma 𝑐𝑖𝑗 = 𝑎𝑖𝑗 + 𝑏𝑖𝑗.
\item
  Subtração 𝑐𝑖𝑗 = 𝑎𝑖𝑗 − 𝑏𝑖𝑗.
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Exemplo \[A = \begin{pmatrix}\
  1 & 2\\
  3 & 4\\
  5 & 6\\
  \end{pmatrix}\]
\end{itemize}

\[B = \begin{pmatrix}\
10 & 20\\
30 & 40\\
50 & 60\\
\end{pmatrix}\]

\[A + B = \begin{pmatrix}\
11 & 22\\
33 & 44\\
55 & 66\\
\end{pmatrix}\]

\begin{itemize}
\tightlist
\item
  Soma de duas matrizes
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{A }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{),}
\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\NormalTok{B }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{,}\DecValTok{20}\NormalTok{,}\DecValTok{30}\NormalTok{,}\DecValTok{40}\NormalTok{,}\DecValTok{50}\NormalTok{,}\DecValTok{60}\NormalTok{),}
\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\NormalTok{C }\OtherTok{=}\NormalTok{ A }\SpecialCharTok{+}\NormalTok{ B}
\NormalTok{C}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]   11   44
## [2,]   22   55
## [3,]   33   66
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [,1] [,2]}
\DocumentationTok{\#\# [1,] 11 44}
\DocumentationTok{\#\# [2,] 22 55}
\DocumentationTok{\#\# [3,] 33 66}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Condição para multiplicar matrizes \[
  C_{m, n} = A_{m,q} B_{q,n}
  \] (q tem que ser igual)
\end{itemize}

C 𝑚×𝑛 = A 𝑚×𝑞 B 𝑞×𝑛. - Cada elemento 𝑐𝑖𝑗 = ∑𝑞 𝑘=1 𝑎𝑖𝑘𝑏𝑘𝑗. ⎛⎜ ⎝ 2 −1 8 3
6 7 ⎞⎟ ⎠ ( 4 9 1 −3 −5 2 4 6 ) = ⎛⎜ ⎝ ((2 ⋅ 4) + (−1 ⋅ −5)) ((2 ⋅ 9) +
(−1 ⋅ 2)) ((2 ⋅ 1) + (−1 ⋅ 4)) ((2 ⋅ −3) + (−1 ⋅ 6)) ((8 ⋅ 4) + (3 ⋅
−5)) ((8 ⋅ 9) + (3 ⋅ 2)) ((8 ⋅ 1) + (3 ⋅ 4)) ((8 ⋅ −3) + (3 ⋅ 6)) ((6 ⋅
4) + (7 ⋅ −5)) ((6 ⋅ 9) + (7 ⋅ 2)) ((6 ⋅ 1) + (7 ⋅ 4)) ((6 ⋅ −3) + (7 ⋅
6)) ⎞⎟ ⎠ = ⎛⎜ ⎝ 13 16 −2 −12 17 78 20 −6 −11 68 34 24 ⎞⎟ ⎠ .

\begin{itemize}
\tightlist
\item
  Computacionalmente.
\item
  Matrizes compatíveis
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{A }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{8}\NormalTok{,}\DecValTok{6}\NormalTok{,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{7}\NormalTok{),}
\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\NormalTok{B }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{4}\NormalTok{,}\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{,}\DecValTok{6}\NormalTok{),}
\AttributeTok{nrow =} \DecValTok{2}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{4}\NormalTok{)}
\NormalTok{C }\OtherTok{=}\NormalTok{ A}\SpecialCharTok{\%*\%}\NormalTok{B}
\NormalTok{C}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3] [,4]
## [1,]   13   16   -2  -12
## [2,]   17   78   20   -6
## [3,]  -11   68   34   24
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [,1] [,2] [,3] [,4]}
\DocumentationTok{\#\# [1,] 13 16 {-}2 {-}12}
\DocumentationTok{\#\# [2,] 17 78 20 {-}6}
\DocumentationTok{\#\# [3,] {-}11 68 34 24}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Matrizes não compatíveis
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{B }\SpecialCharTok{\%*\%}\NormalTok{ A}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Error in B %*% A: argumentos não compatíveis
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Error in B \%*\% A: argumentos não compatíveis}
\end{Highlighting}
\end{Shaded}

Produto de Hadamard - Produto simples ou de Hadamard

\[A \odot B = \begin{pmatrix}\
a_{11}*b_{11} & a_{12}*b_{12} & ... & a_{1m}*b_{1m}\\
a_{21}*b_{21} & a_{22}*b_{22} & ... & a_{2m}*b_{2m}\\
... & ... & ... & ... \\
a_{n1}*b_{n1} & a_{n2}*b_{n2} & ... & a_{nm}*b_{nm}\\
\end{pmatrix}\]

\begin{itemize}
\tightlist
\item
  Computacionalmente
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{A }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{),}
\AttributeTok{nrow =} \DecValTok{2}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\NormalTok{B }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{,}\DecValTok{20}\NormalTok{,}\DecValTok{30}\NormalTok{,}\DecValTok{40}\NormalTok{),}
\AttributeTok{nrow =} \DecValTok{2}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\NormalTok{A}\SpecialCharTok{*}\NormalTok{B}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]   10   90
## [2,]   40  160
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [,1] [,2]}
\DocumentationTok{\#\# [1,] 10 90}
\DocumentationTok{\#\# [2,] 40 160}
\end{Highlighting}
\end{Shaded}

Propriedades envolvendo operações com matrizes - Sendo A, B, C e D
compatíveis temos, 1. \(A + B = B + A\) 2.
\((A + B) + C = A + (B + C)\). 3. \(𝛼(A + B) = 𝛼A + 𝛼B\). 4.
\((𝛼 + 𝛽)A = 𝛼A + 𝛽A\). 5. \(𝛼(AB) = (𝛼A)B = A(𝛼B)\). 6.
\(A(B ± C) = AB ± AC\). 7. \((A ± B)C = AC ± BC\). 8.
\((A−B)(C−D) = AC−BC−AD+BD\).

\begin{itemize}
\tightlist
\item
  Propriedades envolvendo transposta e multiplicação
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Se A é 𝑛 × 𝑚 e B é 𝑚 × 𝑛, então (AB)⊤ = B⊤A⊤.
\item
  Se A, B e C são compatíveis \[
  (ABC)^{⊤}= C^{⊤}B^{⊤}A^{⊤}.
  \]
\end{enumerate}

\hypertarget{matrizes-de-formas-especiais}{%
\subsubsection{Matrizes de formas
especiais}\label{matrizes-de-formas-especiais}}

\begin{itemize}
\tightlist
\item
  Matriz quadrada (m = n) Exemplo 4x4
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{A }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"a11"}\NormalTok{,}\StringTok{"a21"}\NormalTok{,}\StringTok{"a31"}\NormalTok{,}\StringTok{"a41"}\NormalTok{,}\StringTok{"a12"}\NormalTok{,}\StringTok{"a22"}\NormalTok{,}\StringTok{"a32"}\NormalTok{,}\StringTok{"a42"}\NormalTok{,}\StringTok{"a13"}\NormalTok{,}\StringTok{"a23"}\NormalTok{,}\StringTok{"a33"}\NormalTok{,}\StringTok{"a43"}\NormalTok{,}\StringTok{"a14"}\NormalTok{,}\StringTok{"a24"}\NormalTok{,}\StringTok{"a34"}\NormalTok{,}\StringTok{"a44"}\NormalTok{), }\AttributeTok{nrow =} \DecValTok{4}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{4}\NormalTok{)}
\NormalTok{A}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1]  [,2]  [,3]  [,4] 
## [1,] "a11" "a12" "a13" "a14"
## [2,] "a21" "a22" "a23" "a24"
## [3,] "a31" "a32" "a33" "a34"
## [4,] "a41" "a42" "a43" "a44"
\end{verbatim}

\begin{itemize}
\item
  𝑎𝑖𝑖 são os elementos da diagonal.
\item
  𝑎𝑖𝑗 para 𝑖 ≠ 𝑗 → fora da diagonal.
\item
  𝑎𝑖𝑗 para 𝑗 \textgreater{} 𝑖 → acima da diagonal.
\item
  𝑎𝑖𝑗 para 𝑖 \textgreater{} 𝑗 → abaixo da diagonal.
\item
  Matriz diagonal \[D = \begin{pmatrix}\
  a_{11} & 0 & 0 & 0\\
  0 & a_{22} & 0 & 0\\
  0 & 0 & a_{33} & 0 \\
  0 & 0 & 0 & a_{44}\\
  \end{pmatrix}\]
\item
  Matriz identidade I = ⎛⎜⎜⎜⎜ ⎝ 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 ⎞⎟⎟⎟⎟ ⎠
\end{itemize}

\hypertarget{matrizes-de-formas-especiais-1}{%
\subsubsection{Matrizes de formas
especiais}\label{matrizes-de-formas-especiais-1}}

\begin{itemize}
\tightlist
\item
  Triangular superior U = ⎛⎜⎜⎜⎜ ⎝ 𝑎11 𝑎12 𝑎13 𝑎14 0 𝑎22 𝑎23 𝑎24 0 0 𝑎33
  𝑎34 0 0 0 𝑎44 ⎞⎟⎟⎟⎟ ⎠ .
\item
  Triangular inferior L = ⎛⎜⎜⎜⎜ ⎝ 𝑎11 0 0 0 𝑎21 𝑎22 0 0 𝑎31 𝑎32 𝑎33 0
  𝑎41 𝑎42 𝑎43 𝑎44 ⎞⎟⎟⎟⎟ ⎠ .
\item
  Matriz nula 0 = ⎛⎜⎜⎜⎜ ⎝ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ⎞⎟⎟⎟⎟ ⎠ .
\item
  Matriz quadrada simétrica A = ⎛⎜⎜⎜⎜ ⎝ 1 0.8 0.6 0.4 0.8 1 0.2 0.4 0.6
  0.2 1 0.1 0.4 0.4 0.1 1 ⎞⎟⎟⎟⎟ ⎠
\end{itemize}

\hypertarget{combinauxe7uxf5es-lineares}{%
\subsubsection{Combinações lineares}\label{combinauxe7uxf5es-lineares}}

\begin{itemize}
\tightlist
\item
  Um conjunto de vetores a1, a2, \ldots{} , a𝑛 é dito ser linearmente
  dependente se puderem ser encontrados escalares 𝑐1, 𝑐2, \ldots{} , 𝑐𝑛
  e estes escalares não sejam todos iguais a 0 de tal forma que \[
  𝑐1a1 + 𝑐2a2 + … + 𝑐𝑛a𝑛 = 0.
  \]
\end{itemize}

Exemplo:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a1 }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{), }\AttributeTok{nrow =} \DecValTok{2}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{1}\NormalTok{)}
\NormalTok{a1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1]
## [1,]    1
## [2,]    0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a2 }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{nrow =} \DecValTok{2}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{1}\NormalTok{)}
\NormalTok{a2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1]
## [1,]    0
## [2,]    1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#O unico caso que esses c1*a1 + c2*a2 = (0, 0) é se c1 = 0 E c2 =0}
\CommentTok{\#Ou seja Linearmente independente}

\NormalTok{a1 }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{), }\AttributeTok{nrow =} \DecValTok{2}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{1}\NormalTok{)}
\NormalTok{a1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1]
## [1,]    1
## [2,]    2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a2 }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{), }\AttributeTok{nrow =} \DecValTok{2}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{1}\NormalTok{)}
\NormalTok{a2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1]
## [1,]   -1
## [2,]   -2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Existem casos fora os cs = 0 que fazem c1*a1 + c2*a2 = (0, 0)}
\CommentTok{\#Ou seja Linearmente dependente}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Caso contrário é dito ser linearmente independente.
\item
  Notação matricial \[
  Ac = 0.
  \]
\item
  As colunas de A são linearmente independentes se Ac = 0 implicar que c
  = 0.
\end{itemize}

\hypertarget{rank-ou-posto-de-uma-matriz}{%
\subsubsection{Rank ou posto de uma
matriz}\label{rank-ou-posto-de-uma-matriz}}

\begin{itemize}
\tightlist
\item
  O rank ou posto de qualquer matriz quadrada ou retangular A é definido
  como rank(A) = número de colunas ou linhas linearmente independentes
  em A.
\item
  Sendo A uma matriz retangular 𝑛 × 𝑚 o maior rank possível para A é o
  min(𝑛,𝑚).
\item
  O rank da matrix nula é 0.
\item
  Se o rank da matriz é o min(𝑛,𝑚) dizemos que a matriz tem rank
  completo.
\end{itemize}

\hypertarget{matriz-nuxe3o-singular-e-matriz-inversa}{%
\subsubsection{Matriz não singular e matriz
inversa}\label{matriz-nuxe3o-singular-e-matriz-inversa}}

\begin{itemize}
\tightlist
\item
  Uma matriz quadrada de posto completo é chamada de não singular.
\item
  Sendo A quadrada de posto completo a matriz inversa de A é única tal
  que (só se a matriz for quadrada e de ranking completo) \[
  AA^{−1} = I.
  \]
\item
  Não quadrada (posto incompleto) → não terá inversa e é dita ser
  singular.
\item
  Note que \[
  A^{(-1^{-1})} =A
  \] A\textsuperscript{\{−1\}}\{−1\} = A
\end{itemize}

\hypertarget{matriz-inversa}{%
\subsection{Matriz inversa}\label{matriz-inversa}}

\begin{itemize}
\tightlist
\item
  Computacionalmente
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{A }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{6}\NormalTok{), }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{)}
\NormalTok{A}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]    4    7
## [2,]    2    6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{A\_inv }\OtherTok{\textless{}{-}} \FunctionTok{solve}\NormalTok{(A)}
\NormalTok{A\_inv}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]  0.6 -0.7
## [2,] -0.2  0.4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{I }\OtherTok{=}\NormalTok{ A }\SpecialCharTok{\%*\%}\NormalTok{ A\_inv}
\NormalTok{I}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]    1    0
## [2,]    0    1
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Verificando
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{A}\SpecialCharTok{\%*\%}\NormalTok{A\_inv}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]    1    0
## [2,]    0    1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [,1] [,2]}
\DocumentationTok{\#\# [1,] 1 0}
\DocumentationTok{\#\# [2,] 0 1}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Propriedades envolvendo inversas
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Se A é não singular, então A⊤ é não singular e sua inversa é dada por
  (A⊤)−1 = (A−1)⊤.
\item
  Se A e B são matrizes não singulares de mesmo tamanho, então o produto
  AB é não singular e (AB)−1 = B−1A−1.
\end{enumerate}

\hypertarget{inversa-generalizada}{%
\subsubsection{Inversa generalizada}\label{inversa-generalizada}}

\begin{itemize}
\item
  A inversa generalizada de uma matriz A 𝑛 × 𝑝 é qualquer matriz A− que
  satisfaça \[
  AA^{−}A = A.
  \]
\item
  Não é única exceto quando A é não-singular (inversa usual).
\item
  Exemplo
\end{itemize}

\$\$

\$\$

a = ⎛⎜⎜⎜⎜ ⎝ 1 2 3 4 ⎞⎟⎟⎟⎟ ⎠ .

\begin{itemize}
\item
  a− = (1, 0, 0, 0)
\item
  Verificando
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{), }\DecValTok{4}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{a\_invg }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{), }\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\NormalTok{a}\SpecialCharTok{\%*\%}\NormalTok{a\_invg}\SpecialCharTok{\%*\%}\NormalTok{a}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1]
## [1,]    1
## [2,]    2
## [3,]    3
## [4,]    4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [,1]}
\DocumentationTok{\#\# [1,] 1}
\DocumentationTok{\#\# [2,] 2}
\DocumentationTok{\#\# [3,] 3}
\DocumentationTok{\#\# [4,] 4}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Moore-Penrose generalized inverse
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#\# Matriz singular (col 3 = col 2 + col 1)}
\NormalTok{A }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{0}\NormalTok{,}
\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{), }\DecValTok{3}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\FunctionTok{library}\NormalTok{(MASS)}
\NormalTok{A\_ginv }\OtherTok{\textless{}{-}} \FunctionTok{ginv}\NormalTok{(A)}
\NormalTok{A}\SpecialCharTok{\%*\%}\NormalTok{A\_ginv}\SpecialCharTok{\%*\%}\NormalTok{A }\DocumentationTok{\#\# Verificando}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1]         [,2] [,3]
## [1,]    2 2.000000e+00    3
## [2,]    1 2.220446e-16    1
## [3,]    3 2.000000e+00    4
\end{verbatim}

\hypertarget{matrizes-positivas-definidas}{%
\subsection{Matrizes positivas
definidas}\label{matrizes-positivas-definidas}}

\hypertarget{formas-quadruxe1ticas}{%
\subsubsection{Formas quadráticas}\label{formas-quadruxe1ticas}}

\begin{itemize}
\tightlist
\item
  Soma de quadrados são importantes em ciência de dados.
\item
  Considere uma matriz A simétrica e y um vetor, o produto \[
  y^{T}Ay = 
  \sum(a_{ij}y^{2}_{i}) + 
  \sum_{i \differ j}(a_{ij}y_{i}y_{j})
  \] é chamado de forma quadrática.
\end{itemize}

\[
y^{T}Iy = \sum^{n}_{i=0}(y^{2}_{i})
\]

\begin{itemize}
\item
  Sendo y de dimensão 𝑛 × 1, \[
  y⊤Iy = 𝑦2
  1 + 𝑦2
  2 + … , 𝑦2
  n
  \]
\item
  Consequentemente, y⊤y é a soma de quadrados dos elementos do vetor y.
\item
  A raiz quadrada da soma de quadrados é o comprimento de y. ---- 28
  Matriz positiva definida
\item
  Sendo A uma matriz simétrica com a propriedade y⊤Ay \textgreater{} 0
  para todos os possíveis y exceto para quando y = 0, então a forma
  quadrática y⊤Ay é chamada positiva definida, e A é dita ser uma matriz
  positiva definida.
\item
  Exemplo A = ( 2 −1 −1 3 ) . A forma quadrática associada é dada por
  (ver abaixo) que é claramente positiva, desde que 𝑦1 e 𝑦2 sejam
  diferentes de zero. \[
  y⊤Ay = (𝑦1 𝑦2) ( 2 −1
  −1 3 ) (𝑦1
  𝑦2
  ) = 2𝑦2
  1 − 2𝑦1𝑦2 + 3𝑦2
  2 ,
  \]
\end{itemize}

\hypertarget{propriedades-de-matrizes-positivas-definidas}{%
\subsubsection{Propriedades de matrizes positivas
definidas}\label{propriedades-de-matrizes-positivas-definidas}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Se A é positiva definida, então todos os valores da diagonal de A são
  positivos.
\item
  Se A é positiva semi-definida, então os elementos da diagonal de A são
  maiores ou iguais a zero.
\item
  Sendo P uma matriz não-singular e A uma matriz positiva definida, o
  produto P⊤AP é positiva definida.
\item
  Sendo P uma matriz não-singular e A uma matriz positiva semi-definida,
  o produto P⊤AP é positiva semi-definida.
\item
  Uma matriz positiva definida é não-singular.
\end{enumerate}

\hypertarget{determinante-de-uma-matriz}{%
\subsubsection{Determinante de uma
matriz}\label{determinante-de-uma-matriz}}

\begin{itemize}
\tightlist
\item
  O determinante de uma matriz A é o escalar (= numero) \[
  |A| = \sum((-1)^k a_{1j_{1}} a_{2j_{2}} ... a_{nj_{n}})
  \] onde a soma é realizada para todas as 𝑛! permutações de grau 𝑛, e 𝑘
  é o número de mudanças necessárias para que os segundos subscritos
  sejam colocados na ordem 1,2, \ldots{} , 𝑛.
\item
  Considere a matriz A = ( 3 −2 −2 4 ) . \textbar A\textbar{} =
  (−1)0𝑎11𝑎22 + (−1)1𝑎12𝑎21 = 1 ⋅ (3 ⋅ 4) − (−2 ⋅ −2) = 12 − 4 = 8. ----
  32 Determinante de uma matriz
\item
  Computacionalmente. A \textless- matrix(c(3,-2,-2,4),2,2)
  determinant(A, logarithm = FALSE)\$modulus \#\# {[}1{]} 8 \#\#
  attr(,``logarithm'') \#\# {[}1{]} FALSE
\item
  Determinante em escala log. determinant(A, logarithm = TRUE)\$modulus
  \#\# {[}1{]} 2.079442 \#\# attr(,``logarithm'') \#\# {[}1{]} TRUE
\item
  Alguns aspectos interessantes sobre determinantes são:
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Se A é singular, \textbar A\textbar{} = 0.
\item
  Se A é não singular, \textbar A\textbar{} ≠ 0.
\item
  Se A é positiva definida, \textbar A\textbar{} \textgreater{} 0.
\item
  \textbar A⊤\textbar{} = \textbar A\textbar.
\item
  Se A é não singular, \textbar A−1\textbar{} = 1 \textbar A\textbar{} .
  ---- 33 Traço de uma matriz
\end{enumerate}

\begin{itemize}
\tightlist
\item
  O traço de uma matriz A 𝑛 × 𝑛 é um escalar definido como a soma dos
  elementos da diagonal, tr(A) = ∑𝑛 𝑖=1 𝑎𝑖𝑖.
\item
  Propriedades
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Se A e B são 𝑛 × 𝑛, então tr(A + B) = tr(A) + tr(B).
\item
  Se A é 𝑛 × 𝑝 e B e 𝑝 × 𝑛, então tr(AB) = tr(BA).
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Computacionalmente
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{A }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{,}\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{),}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{)}
\FunctionTok{sum}\NormalTok{(}\FunctionTok{diag}\NormalTok{(A))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 7
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [1] 7}
\end{Highlighting}
\end{Shaded}

\hypertarget{cuxe1lculo-vetorial-e-matricial}{%
\subsection{Cálculo vetorial e
matricial}\label{cuxe1lculo-vetorial-e-matricial}}

\hypertarget{cuxe1lculo-vetorial}{%
\subsubsection{Cálculo vetorial}\label{cuxe1lculo-vetorial}}

\begin{itemize}
\tightlist
\item
  Seja \(y = f(x)\) uma função das variáveis
  \(x_{1}, x_{2}, x_{3}, ... , x_{p}\) e 𝜕𝑦 as respectivas derivadas
  parciais.
\end{itemize}

\[
\matrix_vertical de (a1x1, a2x2, .... apxp) 
\]

\[
𝜕𝑥1
, 𝜕𝑦
𝜕𝑥2
, … , 𝜕𝑦
𝜕𝑥𝑝
\]

Assim, \[
\deriv
\]

𝜕𝑦 𝜕x = ⎛⎜⎜⎜⎜⎜ ⎝ 𝜕𝑦 𝜕𝑥1 𝜕𝑦 𝜕𝑥2 ⋮ 𝜕𝑦 𝜕𝑥𝑝 ⎞⎟⎟⎟⎟⎟ ⎠ .

\hypertarget{cuxe1lculo-vetorial-1}{%
\subsubsection{Cálculo vetorial}\label{cuxe1lculo-vetorial-1}}

\begin{itemize}
\tightlist
\item
  Sendo a⊤ = (𝑎1, 𝑎2, \ldots{} , 𝑎𝑝) um vetor de constantes e A uma
  matriz simétrica de constantes.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Seja 𝑦 = a⊤x = x⊤a. Então, \[
  𝜕𝑦
  𝜕x = 𝜕(x⊤a)
  𝜕x = a.
  \]
\item
  Seja 𝑦 = x⊤Ax. Então, \[
  𝜕𝑦
  𝜕x = 𝜕(x⊤Ax)
  𝜕x = 2Ax.
  \]
\end{enumerate}

\hypertarget{cuxe1lculo-matricial}{%
\subsubsection{Cálculo Matricial}\label{cuxe1lculo-matricial}}

\begin{itemize}
\item
  Se 𝑦 = 𝑓(X) onde X é uma matriz 𝑝 × 𝑝. As derivadas parciais de 𝑦 em
  relação a cada 𝑥𝑖𝑗 são organizadas em uma matriz. \[
  𝜕𝑦
  𝜕X = ⎛⎜⎜
  ⎝
  𝜕𝑦
  𝜕𝑥11
  … 𝜕𝑦
  𝜕𝑥1𝑝
  ⋮ ⋱ ⋮
  𝜕𝑦
  𝜕𝑥𝑝1
  … 𝜕𝑦
  𝜕𝑥𝑝𝑝
  ⎞⎟⎟
  \]
\item
  Algumas derivadas importantes envolvendo matrizes são apresentadas
  abaixo.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Seja 𝑦 = tr(XA) sendo X 𝑝 × 𝑝 e definida positiva e A 𝑝 × 𝑝
  constantes. Então, \[
  𝜕𝑦
  𝜕X = 𝜕tr(XA)
  𝜕X = A + A⊤ − diag(A).
  \]
\item
  Sendo A não singular com derivadas 𝜕A \[
  𝜕𝑥 . Então,
  𝜕A−1
  𝜕𝑥 = −A−1 𝜕A
  𝜕𝑥 A−1.
  \]
\item
  Sendo A 𝑛 × 𝑛 positiva definida. Então, \[
  𝜕 log |A|
  𝜕𝑥 = tr (A−1 𝜕A
  𝜕𝑥 )
  \]
\end{enumerate}

\hypertarget{regressuxe3o-linear-muxfaltipla}{%
\subsection{Regressão linear
múltipla}\label{regressuxe3o-linear-muxfaltipla}}

\hypertarget{regressuxe3o-linear-muxfaltipla-especificauxe7uxe3o-usual}{%
\subsubsection{Regressão linear múltipla: especificação
usual}\label{regressuxe3o-linear-muxfaltipla-especificauxe7uxe3o-usual}}

\begin{itemize}
\tightlist
\item
  Regressão linear simples \[
  y_{i} = \beta_{0} +\beta_{1}x_{1} + erro_{i}
  \]
\item
  Regressão linear múltipla \[
  y_{i} = \beta_{0} + \beta_{1}x_{1} + \beta_{2}x_{2} + ... + \beta_{p}x_{ip} + erro_{i}
  \]
\item
  Modelo para cada observação
  \[y_{1} = \beta_{0} + \beta_{1}x_{11} + \beta_{2}x_{12} + ... + \beta_{p}x_{1p} + erro_{1}\]
\end{itemize}

\[y_{2} = \beta_{0} + \beta_{1}x_{21} + \beta_{2}x_{22} + ... + \beta_{p}x_{2p} + erro_{1}\]
\[...\]
\[y_{n} = \beta_{0} + \beta_{1}x_{n1} + \beta_{2}x_{n2} + ... + \beta_{p}x_{np} + erro_{n}\]

Regressão linear múltipla: especificação matricial - Notação matricial
\[
\begin{bmatrix}
y_{1}\\
y_{2}\\
...\\
y_{n}\\
\end{bmatrix}
= 
\begin{bmatrix}
1 & x_{1}\\
1 & x_{2}\\
1 & ...\\
1 & x_{n}\\
\end{bmatrix}
\times
\begin{bmatrix}
\beta_{1}\\
\beta_{2}\\
...\\
\beta_{n}\\
\end{bmatrix}
+
\begin{bmatrix}
erro_{1}\\
erro_{2}\\
...\\
erro_{n}\\
\end{bmatrix}
\]

\begin{itemize}
\tightlist
\item
  Notação mais compacta \[
  y_{(n \times 1)} = X_{(n \times p)} \beta_{(p \times 1)} + erro_{(n \times 1)}
  \] \#\#\# Regressão linear múltipla: estimação (treinamento)
\item
  Objetivo: encontrar o vetor̂ 𝛽, tal que \$𝑆𝑄(𝛽) = (y − X𝛽)⊤(y − X𝛽) \$
  seja a menor possível.
\end{itemize}

\hypertarget{regressuxe3o-linear-muxfaltipla-estimauxe7uxe3o}{%
\subsubsection{Regressão linear múltipla:
estimação}\label{regressuxe3o-linear-muxfaltipla-estimauxe7uxe3o}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Passo 1: encontrar o vetor gradiente. Derivando em 𝛽, temos \[
  𝜕𝑆𝑄(𝛽)
  𝜕𝛽 = 𝜕
  𝜕𝛽 (y − X𝛽)⊤(y − X𝛽)
  = 𝜕
  𝜕𝛽 ((y − X𝛽)⊤) (y − X𝛽) + (y − X𝛽)⊤ 𝜕
  𝜕𝛽 (y − X𝛽)
  = −X⊤(y − X𝛽) + (y − X𝛽)⊤(−X)
  = −2X⊤(y − X𝛽).
  \]
\end{enumerate}

\hypertarget{regressuxe3o-linear-muxfaltipla-estimauxe7uxe3o-1}{%
\subsubsection{Regressão linear múltipla:
estimação}\label{regressuxe3o-linear-muxfaltipla-estimauxe7uxe3o-1}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Passo 2: resolver o sistema de equações lineares (esquece o ``-2''
  primeiro) \[ X^{T} (y - X\hat{\beta}) = 0\] \[X⊤y − X⊤X̂𝛽 = 0\]
  \[X⊤X̂𝛽 = X⊤ŷ\] \[(XTX)^{-1}  X⊤X̂𝛽 = X⊤y (XTX)^{-1}\]
  \[ I𝛽 = (X⊤X)−1X⊤y \]
\end{enumerate}

\hypertarget{regressuxe3o-linear-muxfaltipla-exemplo}{%
\subsubsection{Regressão linear múltipla:
exemplo}\label{regressuxe3o-linear-muxfaltipla-exemplo}}

\begin{itemize}
\tightlist
\item
  Conjunto de dados Boston disponível no pacote MASS.
\item
  Cinco primeiras covariáveis disponíveis:

  \begin{itemize}
  \tightlist
  \item
    crim: taxa de crimes per capita.
  \item
    zn: proporção de terrenos residenciais zoneados para lotes com mais
    de 25.000 pés quadrados.
  \item
    indus: proporção de acres de negócios não varejistas por cidade.
  \item
    chas: variável dummy de Charles River (1 se a área limita o rio; 0
    caso contrário).
  \item
    nox: concentração de óxido de nitrogênio (parte por 10 milhões).
  \end{itemize}
\item
  Variável resposta: medv valor mediano das casas ocupadas em \$1000.
\end{itemize}

\hypertarget{regressuxe3o-linear-muxfaltipla-implementauxe7uxe3o-computacional}{%
\subsubsection{Regressão linear múltipla: implementação
computacional}\label{regressuxe3o-linear-muxfaltipla-implementauxe7uxe3o-computacional}}

\begin{itemize}
\tightlist
\item
  Carregando a base de dados
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{require}\NormalTok{(MASS)}
\DocumentationTok{\#\# Carregando pacotes exigidos: MASS}

\FunctionTok{data}\NormalTok{(Boston)}
\FunctionTok{head}\NormalTok{(Boston[, }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{,}\DecValTok{14}\NormalTok{)])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      crim zn indus chas   nox medv
## 1 0.00632 18  2.31    0 0.538 24.0
## 2 0.02731  0  7.07    0 0.469 21.6
## 3 0.02729  0  7.07    0 0.469 34.7
## 4 0.03237  0  2.18    0 0.458 33.4
## 5 0.06905  0  2.18    0 0.458 36.2
## 6 0.02985  0  2.18    0 0.458 28.7
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# crim zn indus chas nox medv}
\DocumentationTok{\#\# 1 0.00632 18 2.31 0 0.538 24.0}
\DocumentationTok{\#\# 2 0.02731 0 7.07 0 0.469 21.6}
\DocumentationTok{\#\# 3 0.02729 0 7.07 0 0.469 34.7}
\DocumentationTok{\#\# 4 0.03237 0 2.18 0 0.458 33.4}
\DocumentationTok{\#\# 5 0.06905 0 2.18 0 0.458 36.2}
\DocumentationTok{\#\# 6 0.02985 0 2.18 0 0.458 28.7}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Matriz de delineamento (X).
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X }\OtherTok{\textless{}{-}} \FunctionTok{model.matrix}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ crim }\SpecialCharTok{+}\NormalTok{ zn }\SpecialCharTok{+}\NormalTok{ indus }\SpecialCharTok{+}
\NormalTok{chas }\SpecialCharTok{+}\NormalTok{ nox, }\AttributeTok{data =}\NormalTok{ Boston)}
\FunctionTok{head}\NormalTok{(X)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   (Intercept)    crim zn indus chas   nox
## 1           1 0.00632 18  2.31    0 0.538
## 2           1 0.02731  0  7.07    0 0.469
## 3           1 0.02729  0  7.07    0 0.469
## 4           1 0.03237  0  2.18    0 0.458
## 5           1 0.06905  0  2.18    0 0.458
## 6           1 0.02985  0  2.18    0 0.458
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# (Intercept) crim zn indus chas nox}
\DocumentationTok{\#\# 1 1 0.00632 18 2.31 0 0.538}
\DocumentationTok{\#\# 2 1 0.02731 0 7.07 0 0.469}
\DocumentationTok{\#\# 3 1 0.02729 0 7.07 0 0.469}
\DocumentationTok{\#\# 4 1 0.03237 0 2.18 0 0.458}
\DocumentationTok{\#\# 5 1 0.06905 0 2.18 0 0.458}
\DocumentationTok{\#\# 6 1 0.02985 0 2.18 0 0.458}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Variável resposta
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}}\NormalTok{ Boston}\SpecialCharTok{$}\NormalTok{medv}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Estimadores de mínimos quadrados: \[
  \hat{\beta} = (X^{T}X)^{-1} X^{T}y
  \]
\item
  Computacionalmente: versão ingênua (calcula inversa)
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{round}\NormalTok{(}\FunctionTok{solve}\NormalTok{(}\FunctionTok{t}\NormalTok{(X)}\SpecialCharTok{\%*\%}\NormalTok{X)}\SpecialCharTok{\%*\%}\FunctionTok{t}\NormalTok{(X)}\SpecialCharTok{\%*\%}\NormalTok{y, }\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              [,1]
## (Intercept) 29.49
## crim        -0.22
## zn           0.06
## indus       -0.38
## chas         7.03
## nox         -5.42
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [,1]}
\DocumentationTok{\#\# (Intercept) 29.49}
\DocumentationTok{\#\# crim {-}0.22}
\DocumentationTok{\#\# zn 0.06}
\DocumentationTok{\#\# indus {-}0.38}
\DocumentationTok{\#\# chas 7.03}
\DocumentationTok{\#\# nox {-}5.42}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Computacionalmente: versão eficiente (escalona?)
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{round}\NormalTok{(}\FunctionTok{solve}\NormalTok{(}\FunctionTok{t}\NormalTok{(X)}\SpecialCharTok{\%*\%}\NormalTok{X, }\FunctionTok{t}\NormalTok{(X)}\SpecialCharTok{\%*\%}\NormalTok{y), }\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              [,1]
## (Intercept) 29.49
## crim        -0.22
## zn           0.06
## indus       -0.38
## chas         7.03
## nox         -5.42
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# [,1]}
\DocumentationTok{\#\# (Intercept) 29.49}
\DocumentationTok{\#\# crim {-}0.22}
\DocumentationTok{\#\# zn 0.06}
\DocumentationTok{\#\# indus {-}0.38}
\DocumentationTok{\#\# chas 7.03}
\DocumentationTok{\#\# nox {-}5.42}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Função nativa do R
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t}\NormalTok{(}\FunctionTok{round}\NormalTok{(}\FunctionTok{coef}\NormalTok{(}\FunctionTok{lm}\NormalTok{(medv }\SpecialCharTok{\textasciitilde{}}\NormalTok{ crim }\SpecialCharTok{+}\NormalTok{ zn }\SpecialCharTok{+}\NormalTok{ indus }\SpecialCharTok{+}\NormalTok{ chas }\SpecialCharTok{+}\NormalTok{ nox, }\AttributeTok{data =}\NormalTok{ Boston)), }\DecValTok{2}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      (Intercept)  crim   zn indus chas   nox
## [1,]       29.49 -0.22 0.06 -0.38 7.03 -5.42
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# (Intercept) crim zn indus chas nox}
\DocumentationTok{\#\# [1,] 29.49 {-}0.22 0.06 {-}0.38 7.03 {-}5.42}
\end{Highlighting}
\end{Shaded}

\hypertarget{matrizes-esparsas-tuxf3pico-adicional}{%
\subsubsection{Matrizes esparsas (tópico
adicional)}\label{matrizes-esparsas-tuxf3pico-adicional}}

\begin{itemize}
\item
  Matrizes aparecem em todos os tipos de aplicação em ciência de dados.
\item
  Modelos estatísticos, machine learning, análise de texto, análise de
  cluster, etc.
\item
  Muitas vezes as matrizes usadas têm uma grande quantidade de zeros.
\item
  Quando uma matriz tem uma quantidade considerável de zeros, dizemos
  que ela é esparsa, caso contrário dizemos que a matriz é densa.
\item
  Todas as propriedades que vimos para matrizes em geral valem para
  matrizes esparsas.
\item
  O R tem um conjunto de métodos altamente eficiente por meio do pacote
  Matrix.
\item
  Saber que uma matriz é esparsa é útil pois permite:
\item
  Planejar formas de armazenar a matriz em memória.
\item
  Economizar cálculos em algoritmos numéricos (multiplicação, inversa,
  determinante, decomposições, etc).
\item
  Comparando a quantidade de memória utilizada.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(}\StringTok{\textquotesingle{}Matrix\textquotesingle{}}\NormalTok{)}

\NormalTok{m1 }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{1000}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{1000}\NormalTok{)}
\FunctionTok{object.size}\NormalTok{(m1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 8000216 bytes
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# 8000216 bytes}

\NormalTok{m2 }\OtherTok{\textless{}{-}} \FunctionTok{Matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{1000}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{1000}\NormalTok{, }\AttributeTok{sparse =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{object.size}\NormalTok{(m2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 9240 bytes
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# 9240 bytes}
\end{Highlighting}
\end{Shaded}

Comparando o tempo computacional

\begin{itemize}
\tightlist
\item
  Matriz densa
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{1000}\NormalTok{)}
\NormalTok{X }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{100}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{1000}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{) \{X[i,] }\OtherTok{\textless{}{-}} \FunctionTok{rbinom}\NormalTok{(}\DecValTok{100}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{, }\AttributeTok{p =} \FloatTok{0.1}\NormalTok{)\}}
\FunctionTok{system.time}\NormalTok{(}\FunctionTok{replicate}\NormalTok{(}\DecValTok{100}\NormalTok{, }\FunctionTok{solve}\NormalTok{(}\FunctionTok{t}\NormalTok{(X)}\SpecialCharTok{\%*\%}\NormalTok{X, }\FunctionTok{t}\NormalTok{(X)}\SpecialCharTok{\%*\%}\NormalTok{y)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   usuário   sistema decorrido 
##      1.21      0.19      1.40
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# usuário sistema decorrido}
\DocumentationTok{\#\# 0.819 0.004 0.823}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Matriz esparsa
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{1000}\NormalTok{)}
\NormalTok{X }\OtherTok{\textless{}{-}} \FunctionTok{Matrix}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{100}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{1000}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{1000}\NormalTok{) \{X[i,] }\OtherTok{\textless{}{-}} \FunctionTok{rbinom}\NormalTok{(}\DecValTok{100}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{, }\AttributeTok{p =} \FloatTok{0.1}\NormalTok{)\}}
\NormalTok{X }\OtherTok{\textless{}{-}} \FunctionTok{Matrix}\NormalTok{(X, }\AttributeTok{sparse =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{system.time}\NormalTok{(}\FunctionTok{replicate}\NormalTok{(}\DecValTok{100}\NormalTok{, }\FunctionTok{solve}\NormalTok{(}\FunctionTok{t}\NormalTok{(X)}\SpecialCharTok{\%*\%}\NormalTok{X, }\FunctionTok{t}\NormalTok{(X)}\SpecialCharTok{\%*\%}\NormalTok{y)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   usuário   sistema decorrido 
##      0.28      0.03      0.31
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# usuário sistema decorrido}
\DocumentationTok{\#\# 0.223 0.000 0.224}
\end{Highlighting}
\end{Shaded}

\hypertarget{diferentes-formas-de-implementar-as-operauxe7uxf5es-matriciais}{%
\subsubsection{Diferentes formas de implementar as operações
matriciais}\label{diferentes-formas-de-implementar-as-operauxe7uxf5es-matriciais}}

\begin{itemize}
\tightlist
\item
  Criando a base de dados para a comparação
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(Matrix)}
\NormalTok{n }\OtherTok{\textless{}{-}} \DecValTok{10000}\NormalTok{; p }\OtherTok{\textless{}{-}} \DecValTok{500}

\CommentTok{\#DENSA}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{rbinom}\NormalTok{(n}\SpecialCharTok{*}\NormalTok{p, }\DecValTok{1}\NormalTok{, }\FloatTok{0.01}\NormalTok{), }\AttributeTok{nrow=}\NormalTok{n, }\AttributeTok{ncol=}\NormalTok{p)}
\FunctionTok{object.size}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 20000216 bytes
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# 20000216 bytes}

\CommentTok{\#ESPARCA}
\NormalTok{X }\OtherTok{\textless{}{-}} \FunctionTok{Matrix}\NormalTok{(x)}
\FunctionTok{object.size}\NormalTok{(X)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 601080 bytes
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# 600432 bytes}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Diferentes implementações
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n)}

\FunctionTok{print}\NormalTok{(}\StringTok{"Matriz densa com \%*\%:"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Matriz densa com %*%:"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{system.time}\NormalTok{(}\FunctionTok{solve}\NormalTok{(}\FunctionTok{t}\NormalTok{(x)}\SpecialCharTok{\%*\%}\NormalTok{x, }\FunctionTok{t}\NormalTok{(x)}\SpecialCharTok{\%*\%}\NormalTok{y))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   usuário   sistema decorrido 
##      3.33      0.03      3.37
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# usuário sistema decorrido}
\DocumentationTok{\#\# 2.053 0.040 2.094}

\FunctionTok{print}\NormalTok{(}\StringTok{"Matriz densa com crossprod"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Matriz densa com crossprod"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{system.time}\NormalTok{(}\FunctionTok{solve}\NormalTok{(}\FunctionTok{crossprod}\NormalTok{(x), }\FunctionTok{crossprod}\NormalTok{(x, y)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   usuário   sistema decorrido 
##      2.08      0.01      2.09
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# usuário sistema decorrido}
\DocumentationTok{\#\# 1.731 0.016 1.748}

\FunctionTok{print}\NormalTok{(}\StringTok{"Matriz esparça com \%*\%"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Matriz esparça com %*%"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{system.time}\NormalTok{(}\FunctionTok{solve}\NormalTok{(}\FunctionTok{t}\NormalTok{(X)}\SpecialCharTok{\%*\%}\NormalTok{X, }\FunctionTok{t}\NormalTok{(X)}\SpecialCharTok{\%*\%}\NormalTok{y))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   usuário   sistema decorrido 
##      0.13      0.00      0.12
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# usuário sistema decorrido}
\DocumentationTok{\#\# 0.071 0.000 0.072}

\FunctionTok{print}\NormalTok{(}\StringTok{"Matriz esparça com crossprod"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Matriz esparça com crossprod"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{system.time}\NormalTok{(}\FunctionTok{solve}\NormalTok{(}\FunctionTok{crossprod}\NormalTok{(X), }\FunctionTok{crossprod}\NormalTok{(X,y)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   usuário   sistema decorrido 
##      0.05      0.00      0.05
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# usuário sistema decorrido}
\DocumentationTok{\#\# 0.029 0.000 0.050}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  Implementação eficiente do modelo de regressão linear múltipla.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(glmnet)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loaded glmnet 4.1-8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Loaded glmnet 4.1{-}6}
\FunctionTok{system.time}\NormalTok{(b }\OtherTok{\textless{}{-}} \FunctionTok{coef}\NormalTok{(}\FunctionTok{lm}\NormalTok{(y}\SpecialCharTok{\textasciitilde{}}\NormalTok{x)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   usuário   sistema decorrido 
##      2.98      0.08      3.27
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# usuário sistema decorrido}
\DocumentationTok{\#\# 2.389 0.044 2.434}
\FunctionTok{system.time}\NormalTok{(g1 }\OtherTok{\textless{}{-}}\FunctionTok{glmnet}\NormalTok{(x, y, }\AttributeTok{nlambda=}\DecValTok{1}\NormalTok{, }\AttributeTok{lambda=}\DecValTok{0}\NormalTok{, }\AttributeTok{standardize=}\ConstantTok{FALSE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   usuário   sistema decorrido 
##      0.11      0.03      0.14
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# usuário sistema decorrido}
\DocumentationTok{\#\# 0.065 0.020 0.086}
\FunctionTok{system.time}\NormalTok{(g2 }\OtherTok{\textless{}{-}} \FunctionTok{glmnet}\NormalTok{(X, y, }\AttributeTok{nlambda=}\DecValTok{1}\NormalTok{, }\AttributeTok{lambda=}\DecValTok{0}\NormalTok{, }\AttributeTok{standardize=}\ConstantTok{FALSE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   usuário   sistema decorrido 
##      0.02      0.00      0.02
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# usuário sistema decorrido}
\DocumentationTok{\#\# 0.006 0.000 0.006}
\end{Highlighting}
\end{Shaded}

\hypertarget{proxima-aula}{%
\section{Proxima aula}\label{proxima-aula}}

\hypertarget{sistemas-lineares}{%
\subsubsection{Sistemas lineares}\label{sistemas-lineares}}

\begin{itemize}
\tightlist
\item
  Sistema com duas equações: 𝑓1(𝑥1,𝑥2) = 0 𝑓2(𝑥1,𝑥2) = 0.
\item
  Solução numérica consiste em encontrar̂ 𝑥1 ê 𝑥2 que satisfaça o sistema
  de equações.
\item
  Sistema com 𝑛 equações 𝑓1(𝑥1, \ldots{} , 𝑥𝑛) = 0 ⋮ 𝑓𝑛(𝑥1, \ldots{} ,
  𝑥𝑛) = 0.
\item
  Genericamente, tem-se f(𝑥) = 0.
\item
  Equações podem ser lineares ou não-lineares. ---- 58 Sistemas de
  equações lineares
\item
  Cada equação é linear na incógnita.
\item
  Solução analítica em geral é possível.
\item
  Exemplo: 7𝑥1 + 3𝑥2 = 45 4𝑥1 + 5𝑥2 = 29.
\item
  Solução analítica:̂ 𝑥1 = 6 ê 𝑥2 = 1.
\item
  Resolver (tedioso!!).
\item
  Três possíveis casos:
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Uma única solução (sistema não singular).
\item
  Infinitas soluções (sistema singular).
\item
  Nenhuma solução (sistema impossível). ---- 59 Sistemas de equações
  lineares
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Representação matricial do sistema de equações lineares: A = {[}7 3 4
  5{]} , x = {[}𝑥1 𝑥2{]} e b = {[}45 29{]} .
\item
  De forma geral, tem-se Ax = b. ---- 60 Operações com linhas
\item
  Sem qualquer alteração na relação linear, é possível
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Trocar a posição de linhas: 4𝑥1 + 5𝑥2 = 29 7𝑥1 + 3𝑥2 = 45.
\item
  Multiplicar qualquer linha por uma constante, aqui 4𝑥1 + 5𝑥2 por 1 4 ,
  obtendo 𝑥1 + 5 4 𝑥2 = 29 4 (1) 7𝑥1 + 3𝑥2 = 45. (2) ---- 61 Operações
  com linhas
\item
  Subtrair um múltiplo de uma linha de uma outra, aqui 7 ∗ 𝐸𝑞.(1) menos
  Eq. (2), obtendo 𝑥1 + 5 4 𝑥2 = 29 4 0𝑥1 + ( 35 4 − 3)𝑥2 = 203 4 − 45.
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Fazendo as contas, tem-se 0𝑥1 + 23 4 𝑥2 = 23 4 . ---- 62 Solução de
  sistemas lineares
\item
  Forma geral de um sistema com 𝑛 equações lineares: 𝑎11𝑥1 + 𝑎12𝑥2 +
  \ldots{} + 𝑎1𝑛𝑥𝑛 = 𝑏1 𝑎21𝑥1 + 𝑎22𝑥2 + \ldots{} + 𝑎2𝑛𝑥𝑛 = 𝑏2 ⋮ 𝑎𝑛1𝑥1 +
  𝑎𝑛2𝑥2 + \ldots{} + 𝑎𝑛𝑛𝑥𝑛 = 𝑏𝑛
\item
  Matricialmente, tem-se ⎡ ⎢ ⎢ ⎣ 𝑎11 𝑎12 \ldots{} 𝑎1𝑛 𝑎21 𝑎22 \ldots{}
  𝑎2𝑛 ⋮ ⋮ ⋮ \ldots{} 𝑎𝑛1 𝑎𝑛2 \ldots{} 𝑎𝑛𝑛 ⎤ ⎥ ⎥ ⎦ ⎡ ⎢ ⎢ ⎣ 𝑥1 𝑥2 ⋮ 𝑥𝑛 ⎤ ⎥
  ⎥ ⎦ = ⎡ ⎢ ⎢ ⎣ 𝑏1 𝑏2 ⋮ 𝑏𝑛 ⎤ ⎥ ⎥ ⎦
\item
  Métodos diretos e métodos iterativos. ---- 63 Métodos diretos ---- 64
  Métodos diretos
\item
  O sistema de equações é manipulado até se transformar em um sistema
  equivalente de fácil resolução.
\item
  Triangular superior: ⎡ ⎢ ⎢ ⎣ 𝑎11 𝑎12 𝑎13 𝑎14 0 𝑎22 𝑎23 𝑎24 0 0 𝑎33 𝑎34
  0 0 0 𝑎44 ⎤ ⎥ ⎥ ⎦ ⎡ ⎢ ⎢ ⎣ 𝑥1 𝑥2 𝑥3 𝑥4 ⎤ ⎥ ⎥ ⎦ = ⎡ ⎢ ⎢ ⎣ 𝑏1 𝑏2 𝑏3 𝑏4 ⎤
  ⎥ ⎥ ⎦ .
\item
  Substituição regressiva 𝑥𝑛 = 𝑏𝑛 𝑎𝑛𝑛 𝑥𝑖 = 𝑏𝑖 − ∑𝑗=𝑛 𝑗=𝑖+1 𝑎𝑖𝑗𝑥𝑗 𝑎𝑖𝑖 , 𝑖
  = 𝑛 − 1, 𝑛 − 2, \ldots{} , 1. ---- 65 Métodos diretos
\item
  Triangular inferior: ⎡ ⎢ ⎢ ⎣ 𝑎11 0 0 0 𝑎21 𝑎22 0 0 𝑎31 𝑎32 𝑎33 0 𝑎41
  𝑎42 𝑎43 𝑎44 ⎤ ⎥ ⎥ ⎦ ⎡ ⎢ ⎢ ⎣ 𝑥1 𝑥2 𝑥3 𝑥4 ⎤ ⎥ ⎥ ⎦ = ⎡ ⎢ ⎢ ⎣ 𝑏1 𝑏2 𝑏3 𝑏4
  ⎤ ⎥ ⎥ ⎦ .
\item
  Substituição progressiva 𝑥1 = 𝑏1 𝑎11 𝑥𝑖 = 𝑏𝑖 − ∑𝑗=𝑖−1 𝑗=𝑖 𝑎𝑖𝑗𝑥𝑗 𝑎𝑖𝑖 ,
  𝑖 = 2, 3, \ldots{} , 𝑛. ---- 66 Métodos diretos
\item
  Diagonal: ⎡ ⎢ ⎢ ⎣ 𝑎11 0 0 0 0 𝑎22 0 0 0 0 𝑎33 0 0 0 0 𝑎44 ⎤ ⎥ ⎥ ⎦ ⎡ ⎢
  ⎢ ⎣ 𝑥1 𝑥2 𝑥3 𝑥4 ⎤ ⎥ ⎥ ⎦ = ⎡ ⎢ ⎢ ⎣ 𝑏1 𝑏2 𝑏3 𝑏4 ⎤ ⎥ ⎥ ⎦ . ---- 67
  Eliminação de Gauss ---- 68 Métodos diretos: Eliminação de Gauss
\item
  Método de Eliminação de Gauss consiste em manipular o sistema original
  usando operações de linha até obter um sistema triangular superior.
  {[} 𝑎11 𝑎12 𝑎13 𝑎14 𝑎21 𝑎22 𝑎23 𝑎24 𝑎31 𝑎23 𝑎33 𝑎34 𝑎41 𝑎24 𝑎34 𝑎44{]}
  {[} 𝑥1 𝑥2 𝑥3 𝑥4{]} = {[} 𝑏1 𝑏2 𝑏3 𝑏4{]} → {[} 𝑎11 𝑎12 𝑎13 𝑎14 0 𝑎′ 22
  𝑎′ 23 𝑎′ 24 0 0 𝑎′ 33 𝑎′ 34 0 0 0 𝑎′ 44{]} {[} 𝑥1 𝑥2 𝑥3 𝑥4{]} = {[} 𝑏1
  𝑏′ 2 𝑏′ 3 𝑏′ 4{]}
\item
  Usar eliminação regressiva no novo sistema para obter a solução.
\item
  Resolva o seguinte sistema usando Eliminação de Gauss. ⎡ ⎢ ⎣ 3 2 6 2 4
  3 5 3 4 ⎤ ⎥ ⎦ ⎡ ⎢ ⎣ 𝑥1 𝑥2 𝑥3 ⎤ ⎥ ⎦ = ⎡ ⎢ ⎣ 24 23 33 ⎤ ⎥ ⎦ ---- 69
  Métodos diretos: Eliminação de Gauss
\item
  Passo 1: encontrar o pivô e eliminar os elementos abaixo dele usando
  operações de linha. {[} {[}3{]} 2 6 2 − 2 3 3 4 − 2 3 2 3 − 2 3 6 5 −
  5 3 3 3 − 5 3 2 4 − 5 3 6{]} {[} 24 23 − 2 3 24 33 − 5 3 24{]} →
  {[}{[}3{]} 2 6 0 8 3 −1 0 − 1 3 −6{]} {[}24 7 −7{]}
\item
  Passo 2: encontrar o segundo pivô e eliminar os elementos abaixo dele
  usando operações de linha. {[}3 2 6 0 {[} 8 3 {]} −1 0 − 1 3 − (− 3 24
  ) ( 8 3 ) −6 − (− 3 24 )(−1){]} {[} 24 7 −7 − (− 3 24 )(7){]} → {[}3 2
  6 0 {[} 8 3 {]} −1 0 0 − 147 24{]} {[} 24 7 − 147 24{]}
\item
  Passo 3: substituição regressiva. ---- 70 Métodos diretos: Eliminação
  de Gauss
\item
  Usando a fórmula de substituição regressiva temos:
\item
  𝑥3 = 𝑏3 𝑎33 = 1.
\item
  𝑥2 = 𝑏2−𝑎23𝑥3 𝑎22 = 3.
\item
  𝑥1 = (𝑏1−(𝑎12𝑥2+𝑎13𝑥3) 𝑎11 = 4.
\item
  A extensão do procedimento para um sistema com 𝑛 equações é trivial.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Transforme o sistema em triangular superior usando operações linhas.
\item
  Resolva o novo sistema usando substituição regressiva.
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Potenciais problemas do método de eliminação de Gauss:
\item
  O elemento pivô é zero.
\item
  O elemento pivô é pequeno em relação aos demais termos. ---- 71
  Eliminação de Gauss com pivotação ---- 72 Eliminação de Gauss com
  pivotação
\item
  Considere o sistema 0𝑥1 + 2𝑥2 + 3𝑥2 = 46 4𝑥1 − 3𝑥2 + 2𝑥3 = 16 2𝑥1 +
  4𝑥2 − 3𝑥3 = 12
\item
  Neste caso o pivô é zero e o procedimento não pode começar.
\item
  Pivotação - trocar a ordem das linhas.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Evitar pivôs zero.
\item
  Diminuir o número de operações necessárias para triangular o sistema.
  4𝑥1 − 3𝑥2 + 2𝑥3 = 16 2𝑥1 + 4𝑥2 − 3𝑥3 = 12 0𝑥1 + 2𝑥2 + 3𝑥2 = 46 ---- 73
  Eliminação de Gauss com pivotação
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Se durante o procedimento uma equação pivô tiver um elemento nulo e o
  sistema tiver solução, uma equação com um elemento pivô diferente de
  zero sempre existirá.
\item
  Cálculos numéricos são menos propensos a erros e apresentam menores
  erros de arredondamento se o elemento pivô for grande em valor
  absoluto.
\item
  É usual ordenar as linhas para que o maior valor seja o primeiro pivô.
  ---- 74 Passo 1: obtendo uma matriz triangular superior. gauss
  \textless- function(A, b) \{ Ae \textless- cbind(A, b) \#\# Sistema
  aumentado rownames(Ae) \textless- paste0(``x'', 1:length(b)) n\_row
  \textless- nrow(Ae) n\_col \textless- ncol(Ae) SOL \textless-
  matrix(NA, n\_row, n\_col) \#\# Matriz para receber os resultados
  SOL{[}1,{]} \textless- Ae{[}1,{]} pivo \textless- matrix(0, n\_col,
  n\_row) for(j in 1:c(n\_row-1)) \{ for(i in c(j+1):c(n\_row)) \{
  pivo{[}i,j{]} \textless- Ae{[}i,j{]}/SOL{[}j,j{]} SOL{[}i,{]}
  \textless- Ae{[}i,{]} - pivo{[}i,j{]}*SOL{[}j,{]} Ae{[}i,{]}
  \textless- SOL{[}i,{]} \} \} return(SOL) \} ---- 75 Eliminação de
  Gauss sem pivotação
\item
  Passo 2: substituição regressiva sub\_reg \textless- function(SOL) \{
  n\_row \textless- nrow(SOL) n\_col \textless- ncol(SOL) A \textless-
  SOL{[}1:n\_row,1:n\_row{]} b \textless- SOL{[},n\_col{]} n \textless-
  length(b) x \textless- c() x{[}n{]} \textless- b{[}n{]}/A{[}n,n{]}
  for(i in (n-1):1) \{ x{[}i{]} \textless- (b{[}i{]} -
  sum(A{[}i,c(i+1):n{]}*x{[}c(i+1):n{]} ))/A{[}i,i{]} \} return(x) \}
  ---- 76 Eliminação de Gauss sem pivotação
\item
  Resolva o sistema: ⎡ ⎢ ⎣ 3 2 6 2 4 3 5 3 4 ⎤ ⎥ ⎦ ⎡ ⎢ ⎣ 𝑥1 𝑥2 𝑥3 ⎤ ⎥ ⎦
  = ⎡ ⎢ ⎣ 24 23 33 ⎤ ⎥ ⎦ . A \textless- matrix(c(3,2,5,2,4,3,6,3,4),3,3)
  b \textless- c(24,23,33) S \textless- gauss(A, b) \#\# Passo 1:
  Triangularização sol = sub\_reg(SOL = S) \#\# Passo 2: Substituição
  regressiva sol \#\# {[}1{]} 4 3 1 A\%*\%sol \#\# Verificando a solução
  \#\# {[},1{]} \#\# {[}1,{]} 24 \#\# {[}2,{]} 23 \#\# {[}3,{]} 33 ----
  77 Eliminação de Gauss com pivotação
\item
  Resolva o seguinte sistema usando Eliminação de Gauss com pivotação.
  0𝑥1 + 2𝑥2 + 3𝑥2 = 46 4𝑥1 − 3𝑥2 + 2𝑥3 = 16 2𝑥1 + 4𝑥2 − 3𝑥3 = 12 \#\#
  Entrando com o sistema original A \textless-
  matrix(c(0,4,2,2,-3,4,3,2,-3), 3,3) b \textless- c(46,16,12) \#\#
  Pivoteamento A\_order \textless- A{[}order(A{[},1{]}, decreasing =
  TRUE),{]} b\_order \textless- b{[}order(A{[},1{]}, decreasing =
  TRUE){]} \#\#\#\# Triangulação S \textless- gauss(A\_order, b\_order)
  S \#\# {[},1{]} {[},2{]} {[},3{]} {[},4{]} \#\# {[}1,{]} 4 -3.0
  2.000000 16.00000 \#\# {[}2,{]} 0 5.5 -4.000000 4.00000 \#\# {[}3,{]}
  0 0.0 4.454545 44.54545 \#\#\#\# Substituição regressiva sol
  \textless- sub\_reg(SOL = S) sol \#\# {[}1{]} 5 8 10 \#\#\#\# Solução
  A\_order\%*\%sol \#\# {[},1{]} \#\# {[}1,{]} 16 \#\# {[}2,{]} 12 \#\#
  {[}3,{]} 46 ---- 78 Eliminação de Gauss-Jordan ---- 79 Métodos
  diretos: Eliminação de Gauss-Jordan
\item
  O sistema original é manipulado até obter um sistema equivalente na
  forma diagonal. {[} 𝑎11 𝑎12 𝑎13 𝑎14 𝑎21 𝑎22 𝑎23 𝑎24 𝑎31 𝑎23 𝑎33 𝑎34
  𝑎41 𝑎24 𝑎34 𝑎44{]} {[} 𝑥1 𝑥2 𝑥3 𝑥4{]} = {[} 𝑏1 𝑏2 𝑏3 𝑏4{]} → {[} 1 0 0
  0 0 1 0 0 0 0 1 0 0 0 0 1{]} {[} 𝑥1 𝑥2 𝑥3 𝑥4{]} = {[} 𝑏′ 1 𝑏′ 2 𝑏′ 3
  𝑏′ 4{]}
\item
  Algoritmo Gauss-Jordan
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Normalize a equação pivô com a divisão de todos os seus termos pelo
  coeficiente pivô.
\item
  Elimine os elementos fora da diagonal principal em TODAS as demais
  equações usando operaçõs de linha.
\end{enumerate}

\begin{itemize}
\tightlist
\item
  O método de Gauss-Jordan pode ser combinado com pivotação igual ao
  método de eliminação de Gauss. ---- 80 Métodos iterativos ---- 81
  Métodos iterativos
\item
  Nos métodos iterativos, as equações são colocadas em uma forma
  explícita onde cada incógnita é escrita em termos das demais, i.e.
  𝑎11𝑥1 + 𝑎12𝑥2 + 𝑎13𝑥3 = 𝑏1 𝑎21𝑥1 + 𝑎22𝑥2 + 𝑎23𝑥3 = 𝑏2 𝑎31𝑥1 + 𝑎32𝑥2 +
  𝑎33𝑥3 = 𝑏3 → 𝑥1 = {[}𝑏1 − (𝑎12𝑥2 + 𝑎13𝑥3){]}/𝑎11 𝑥2 = {[}𝑏2 − (𝑎21𝑥1 +
  𝑎23𝑥3){]}/𝑎22 𝑥3 = {[}𝑏3 − (𝑎31𝑥1 + 𝑎32𝑥2){]}/𝑎33 .
\item
  Dado um valor inicial para as incógnitas estas serão atualizadas até a
  convergência.
\item
  Atualização: Método de Jacobi 𝑥𝑖 = 1 𝑎𝑖𝑖 {[}𝑏𝑖 − ( 𝑗=𝑛 ∑ 𝑗=1;𝑗≠𝑖
  𝑎𝑖𝑗𝑥𝑗){]} 𝑖 = 1, \ldots{} , 𝑛. ---- 82 Métodos iterativos
\item
  Atualização: Método de Gauss-Seidel 𝑥𝑘+1 1 = 1 𝑎11 {[}𝑏1 − 𝑗=𝑛 ∑ 𝑗=2
  𝑎1𝑗𝑥(𝑘) 𝑗 {]} , 𝑥(𝑘+1) 𝑖 = 1 𝑎𝑖𝑖 {[}𝑏𝑖 − ( 𝑗=𝑖−1 ∑ 𝑗=1 𝑎𝑖𝑗𝑥(𝑘+1) 𝑗 +
  𝑗=𝑛 ∑ 𝑗=𝑖+1 𝑎𝑖𝑗𝑥(𝑘) 𝑗 ){]} 𝑖 = 2, 3, \ldots{} , 𝑛 − 1 e 𝑥(𝑘+1) 𝑛 = 1
  𝑎𝑛𝑛 {[}𝑏𝑛 − 𝑗=𝑛−1 ∑ 𝑗=1 𝑎𝑛𝑗𝑥(𝑘+1) 𝑗 {]} . ---- 83 Método iterativo de
  Jacobi
\item
  Implementação computacional jacobi \textless- function(A, b, inicial,
  max\_iter = 10, tol = 1e-04) \{ n \textless- length(b) x\_temp
  \textless- matrix(NA, ncol = n, nrow = max\_iter) x\_temp{[}1,{]}
  \textless- inicial x \textless- x\_temp{[}1,{]} for(j in 2:max\_iter)
  \{ \#\#\#\# Equação de atualização for(i in 1:n) \{ x\_temp{[}j,i{]}
  \textless- (b{[}i{]} - sum(A{[}i,1:n{]}{[}-i{]}*x{[}-i{]}))/A{[}i,i{]}
  \} x \textless- x\_temp{[}j,{]} if(sum(abs(x\_temp{[}j,{]} -
  x\_temp{[}c(j-1),{]})) \textless{} tol) break \#\#\#\# Critério de
  parada \} return(list(``Solucao'' = x, ``Iteracoes'' = x\_temp)) \}
  ---- 84 Método iterativo de Jacobi
\item
  Resolva o seguinte sistema de equações lineares usando o método de
  Jacobi. 9𝑥1 − 2𝑥2 + 3𝑥3 + 2𝑥4 = 54.5 2𝑥1 + 8𝑥2 − 2𝑥3 + 3𝑥4 = −14 −3𝑥1
  + 2𝑥2 + 11𝑥3 − 4𝑥4 = 12.5 −2𝑥1 + 3𝑥2 + 2𝑥3 − 10𝑥4 = −21
\item
  Computacionalmente A \textless- matrix(c(9,2,-3,-2,-2,8,2,
  3,3,-2,11,2,2,3,-4,10),4,4) b \textless- c(54.5, -14, 12.5, -21) ss
  \textless- jacobi(A = A, b = b, inicial = c(0,0,0,0), max\_iter = 15)
  \#\# Solução aproximada ss\$Solucao \#\# {[}1{]} 4.999502 -1.999771
  2.500056 -1.000174 \#\# Solução exata solve(A, b) \#\# {[}1{]} 5.0
  -2.0 2.5 -1.0 ---- 85 Métodos iterativo de Jacobi e Gauss-Seidel
\item
  Em R o pacote Rlinsolve fornece implementações eficientes dos métodos
  de Jacobi e Gauss-Seidel.
\item
  Rlinsolve inclui suporte para matrizes esparsas via Matrix.
\item
  Rlinsolve é implementado em C++ usando o pacote Rcpp. A \textless-
  matrix(c(9,2,-3,-2,-2,8,2,3,3,-2,11, 2,2,3,-4,10),4,4) b \textless-
  c(54.5, -14, 12.5, -21) \#\# pacote extra require(Rlinsolve)
  lsolve.jacobi(A,
  b)\(x ## Método de jacobi ## [,1] ## [1,] 4.9999708 ## [2,] -2.0000631 ## [3,] 2.5000163 ## [4,] -0.9999483 lsolve.gs(A, b)\)x
  \#\# Método de Gauss-Seidell \#\# {[},1{]} \#\# {[}1,{]} 4.999955 \#\#
  {[}2,{]} -2.000071 \#\# {[}3,{]} 2.500018 \#\# {[}4,{]} -0.999968 ----
  86 Decomposição LU ---- 87 Decomposição LU
\item
  Nos métodos de eliminação de Gauss e Gauss-Jordan resolvemos sistemas
  do tipo A𝑥 = 𝑏.
\item
  Sendo dois sistemas A𝑥 = 𝑏1, e A𝑥 = 𝑏2.
\item
  Cálculos do primeiro não ajudam a resolver o segundo.
\item
  IDEAL! - Operações realizadas em A fossem dissociadas das operações em
  𝑏. ---- 88 Decomposição LU
\item
  Suponha que precisamos resolver vários sistemas do tipo A𝑥 = 𝑏. para
  diferentes 𝑏′𝑠.
\item
  Opção 1 - calcular a inversa A−1, assim a solução 𝑥 = A−1𝑏.
\item
  Cálculo da inversa é computacionalmente ineficiente. ---- 89
  Decomposição LU: algoritmo
\item
  Decomponha (fatore) a matriz A em um produto de duas matrizes A = LU,
  onde L é triangular inferior e U é triangular superior.
\item
  Baseado na decomposição o sistema tem a forma: LU𝑥 = 𝑏. (3)
\item
  Defina U𝑥 = 𝑦.
\item
  Substituindo em 3 tem-se L𝑦 = 𝑏. (4)
\item
  Solução é obtida em dois passos
\item
  Resolva Eq.(4) para obter 𝑦 usando substituição progressiva.
\item
  Resolva Eq.(3) para obter 𝑥 usando substituição regressiva. ---- 90
  Obtendo as matrizes L e U
\item
  Método de eliminação de Gauss e método de Crout.
\item
  Dentro do processo de eliminação de Gauss as matrizes L e U são
  obtidas como um subproduto, i.e. {[} 𝑎11 𝑎12 𝑎13 𝑎14 𝑎21 𝑎22 𝑎23 𝑎24
  𝑎31 𝑎32 𝑎33 𝑎34 𝑎41 𝑎41 𝑎43 𝑎44{]} = {[} 1 𝑚21 1 𝑚31 𝑚32 1 𝑚41 𝑚42 𝑚43
  1{]} {[} 𝑎11 𝑎12 𝑎13 𝑎14 0 𝑎′ 22 𝑎′ 23 𝑎′ 24 0 0 𝑎′ 33 𝑎′ 34 0 0 0 𝑎′
  44{]} .
\item
  Os elementos 𝑚′ 𝑖𝑗𝑠 são os multiplicadores que multiplicam a equação
  pivô. ---- 91 Obtendo as matrizes L e U
\item
  Relembre o exemplo de eliminação de Gauss. {[} {[}3{]} 2 6 2 − 2 3 3 4
  − 2 3 2 3 − 2 3 6 5 − 5 3 3 3 − 5 3 2 4 − 5 3 6{]} {[} 24 23 − 2 3 24
  33 − 5 3 24{]} → {[}{[}3{]} 2 6 0 8 3 −1 0 − 1 3 −6{]} {[}24 7 −7{]}
  {[}3 2 6 0 {[} 8 3 {]} −1 0 − 1 3 − (− 3 24 ) ( 8 3 ) −6 − (− 3 24
  )(−1){]} {[} 24 7 −7 − (− 3 24 )(7){]} → {[}3 2 6 0 {[} 8 3 {]} −1 0 0
  − 147 24{]} {[} 24 7 − 147 24{]}
\item
  Neste caso, tem-se L = ⎡ ⎢ ⎣ 1 2 3 1 5 3 − 3 24 1 ⎤ ⎥ ⎦ e U = ⎡ ⎢ ⎣ 3
  2 6 0 8 3 −1 0 0 − 147 24 ⎤ ⎥ ⎦ . ---- 92 Decomposição LU com
  pivotação ---- 93 Decomposição LU com pivotação
\item
  O método de eliminação de Gauss foi realizado sem pivotação.
\item
  Como discutido a pivotação pode ser necessária.
\item
  Quando realizada a pivotação as mudanças feitas devem ser armazenadas,
  tal que PA = LU.
\item
  P é uma matriz de permutação.
\item
  Se as matrizes LU forem usadas para resolver o sistema A𝑥 = 𝑏, então a
  ordem das linhas de 𝑏 deve ser alterada de forma consistente com a
  pivotação, i.e.~P𝑏. ---- 94 Implementação: Decomposição LU
\item
  Podemos facilmente modificar a função gauss() para obter a
  decomposição LU. my\_lu \textless- function(A) \{ n\_row \textless-
  nrow(A) n\_col \textless- ncol(A) SOL \textless- matrix(NA, n\_row,
  n\_col) \#\# Matriz para receber os resultados SOL{[}1,{]} \textless-
  A{[}1,{]} pivo \textless- matrix(0, n\_col, n\_row) for(j in
  1:c(n\_row-1)) \{ for(i in c(j+1):c(n\_row)) \{ pivo{[}i,j{]}
  \textless- A{[}i,j{]}/SOL{[}j,j{]} SOL{[}i,{]} \textless- A{[}i,{]} -
  pivo{[}i,j{]}*SOL{[}j,{]} A{[}i,{]} \textless- SOL{[}i,{]} \} \}
  diag(pivo) \textless- 1 return(list(``L'' = pivo, ``U'' = SOL)) \}
  ---- 95 Aplicação: Decomposição LU
\item
  Fazendo a decomposição. LU \textless- my\_lu(A) \#\# Decomposição LU
  \#\# \$L \#\# {[},1{]} {[},2{]} {[},3{]} {[},4{]} \#\# {[}1,{]}
  1.0000000 0.0000000 0.000000 0 \#\# {[}2,{]} 0.2222222 1.0000000
  0.000000 0 \#\# {[}3,{]} -0.3333333 0.1578947 1.000000 0 \#\# {[}4,{]}
  -0.2222222 0.3026316 0.279661 1 \#\# \#\#
  \(U ## [,1] [,2] [,3] [,4] ## [1,] 9 -2.000000e+00 3.000000 2.000000 ## [2,] 0 8.444444e+00 -2.666667 2.555556 ## [3,] 0 0.000000e+00 12.421053 -3.736842 ## [4,] 0 -4.440892e-16 0.000000 10.716102 LU\)L
  \%*\% LU\$U \#\# Verificando a solução \#\# {[},1{]} {[},2{]} {[},3{]}
  {[},4{]} \#\# {[}1,{]} 9 -2 3 2 \#\# {[}2,{]} 2 8 -2 3 \#\# {[}3,{]}
  -3 2 11 -4 \#\# {[}4,{]} -2 3 2 10 ---- 96 Aplicação: Decomposição LU
\item
  Resolvendo o sistema de equações. \#\# Passo 1: Substituição
  progressiva y =
  forwardsolve(LU\(L, b) ## Passo 2: Substituição regressiva x = backsolve(LU\)U,
  y) x \#\# {[}1{]} 5.0 -2.0 2.5 -1.0 A\%*\%x \#\# Verificando a solução
  \#\# {[},1{]} \#\# {[}1,{]} 54.5 \#\# {[}2,{]} -14.0 \#\# {[}3,{]}
  12.5 \#\# {[}4,{]} -21.0
\item
  Função lu() do Matrix fornece a decomposição LU. require(Matrix) \#\#
  Calcula mas não retorna LU\_M \textless- lu(A) \#\# Captura as
  matrizes L U e P LU\_M \textless- expand(LU\_M) \#\# Substituição
  progressiva. y \textless- forwardsolve(LU\_M\(L, LU_M\)P\%*\%b) \#\#
  Substituição regressiva x = backsolve(LU\_M\$U, y) x \#\# {[}1{]} 5.0
  -2.0 2.5 -1.0 ---- 97 Obtendo a inversa ---- 98 Obtendo a inversa via
  decomposição LU
\item
  O método LU é especialmente adequado para o cálculo da inversa.
\item
  Lembre-se que a inversa de A é tal que AA−1 = I.
\item
  O procedimento de cálculo da inversa é essencialmente o mesmo da
  solução de um sistema de equações lineares, porém com mais incognitas.
  ⎡ ⎢ ⎣ 𝑎11 𝑎12 𝑎13 𝑎21 𝑎22 𝑎23 𝑎31 𝑎32 𝑎33 ⎤ ⎥ ⎦ ⎡ ⎢ ⎣ 𝑥11 𝑥12 𝑥13 𝑥21
  𝑥22 𝑥23 𝑥31 𝑥32 𝑥33 ⎤ ⎥ ⎦ = ⎡ ⎢ ⎣ 1 0 0 0 1 0 0 0 1 ⎤ ⎥ ⎦
\item
  Três sistemas de equações diferentes, em cada sistema, uma coluna da
  matriz X é a incognita. ---- 99 Implementação: inversa via
  decomposição LU
\item
  Função para resolver o sistema usando decomposição LU. solve\_lu
  \textless- function(LU, b) \{ y \textless-
  forwardsolve(LU\_M\(L, LU_M\)P\%*\%b) x = backsolve(LU\_M\$U, y)
  return(x) \}
\item
  Resolvendo vários sistemas my\_solve \textless- function(LU, B) \{
  n\_col \textless- ncol(B) n\_row \textless- nrow(B) inv \textless-
  matrix(NA, n\_col, n\_row) for(i in 1:n\_col) \{ inv{[},i{]}
  \textless- solve\_lu(LU, B{[},i{]}) \} return(inv) \} ---- 100
  Aplicação: inversa via decomposição LU
\item
  Calcule a inversa de A = ⎡ ⎢ ⎣ 3 2 6 2 4 3 5 3 4 ⎤ ⎥ ⎦ A \textless-
  matrix(c(3,2,5,2,4,3,6,3,4),3,3) I \textless- Diagonal(3, 1) \#\#
  Decomposição LU LU \textless- my\_lu(A) \#\# Obtendo a inversa inv\_A
  \textless- my\_solve(LU = LU, B = I) inv\_A \#\# Verificando o
  resultado A\%*\%inv\_A ---- 101 Cálculo da inversa via método de
  Gauss-Jordan
\item
  Procedimento Gauss-Jordan: ⎡ ⎢ ⎣ 𝑎11 𝑎21 𝑎31 1 0 0 𝑎21 𝑎22 𝑎32 0 1 0
  𝑎31 𝑎32 𝑎33 0 0 1 ⎤ ⎥ ⎦ → ⎡ ⎢ ⎣ 1 0 0 𝑎′ 11 𝑎′ 21 𝑎′ 31 0 1 0 𝑎′ 21 𝑎′
  22 𝑎′ 32 0 0 1 𝑎′ 31 𝑎′ 32 𝑎′ 33 ⎤ ⎥ ⎦ .
\item
  Função solve() usa a decomposição LU com pivotação.
\item
  R básico é construído sobre a biblioteca lapack escrita em C.
\item
  Veja documentação em
  \url{http://www.netlib.org/lapack/lug/node38.html}. ---- 102
  Autovalores e autovetores ---- 103 Autovalores e autovetores
\item
  Redução de dimensionalidade é fundamental em ciência de dados.
\item
  Análise de componentes principais (PCA)
\item
  Análise fatorial (AF).
\item
  Decompor grandes e complicados relacionamentos multivariados em
  simples componentes não relacionados.
\item
  Vamos discutir apenas os aspectos matemáticos. ---- 104 Intuição
\item
  Podemos decompor um vetor 𝑣 em duas informações separadas: direção 𝑑 e
  tamanho 𝜆, i.e 𝜆 = \textbar\textbar 𝑣\textbar\textbar{} = \sqr∑ 𝑗 𝜈2 𝑗
  , e 𝑑 = 𝑣 𝜆 .
\item
  É mais fácil interpretar o tamanho de um vetor enquanto ignorando a
  sua direção e vice-versa.
\item
  Esta ideia pode ser estendida para matrizes.
\item
  Uma matriz nada mais é do que um conjunto de vetores.
\item
  IDEIA - decompor a informação de uma matriz em outros componentes de
  mais fácil interpretação/representação matemática. ---- 105
  Autovalores e Autovetores
\item
  Autovalores e autovetores são definidos por uma simples igualdade A𝑣 =
  𝜆𝑣. (5)
\item
  Os vetores 𝑣's que satisfazem Eq. (5) são os autovetores.
\item
  Os valores 𝜆's que satisfazem Eq. (5) são os autovalores.
\item
  Vamos considerar o caso em que A é simétrica.
\item
  A ideia pode ser estendida para matrizes não simétricas. ---- 106
  Autovalores e Autovetores
\item
  Se A é uma matriz simétrica 𝑛 × 𝑛, então existem exatamente 𝑛 pares
  (𝜆𝑗, 𝑣𝑗) que satisfazem a equação: A𝑣 = 𝜆𝑣.
\item
  Se A tem autovalores 𝜆1, \ldots{} , 𝜆𝑛, então:
\item
  tr(A) = ∑𝑛 𝑖=1 𝜆𝑖.
\item
  det(A) = ∏𝑛 𝑖=1 𝜆𝑖.
\item
  A é positiva definida, se e somente se todos 𝜆𝑗 \textgreater{} 0.
\item
  A é semi-positiva definida, se e somente se todos 𝜆𝑗 ≥ 0.
\item
  A ideia do PCA é decompor/fatorar a matriz A em componentes mais
  simples de interpretar. ---- 107 Decomposição em autovalores e
  autovetores
\item
  Teorema: qualquer matriz simétrica A pode ser fatorada em A = QΛQ⊤,
  onde Λ é diagonal contendo os autovalores de A e as colunas de Q
  contêm os autovetores ortonormais.
\item
  Vetores ortonormais: são mutuamente ortogonais e de comprimento
  unitário.
\item
  Teorema: se A tem autovetores Q e autovalores 𝜆𝑗. Então A−1 tem
  autovetores Q e autovalores 𝜆−1 𝑗 .
\item
  Implicação: se A = QΛQ⊤ então A−1 = QΛ−1Q⊤. ---- 108 Diagonalização
\item
  Autovalores são utéis porque eles permitem lidar com matrizes da mesma
  forma que lidamos com números.
\item
  Todos os cálculos são feitos na matriz diagonal Λ.
\item
  Este processo é chamado de diagonalização.
\item
  Um dos resultados mais poderosos em Álgebra Linear é que qualquer
  matriz pode ser diagonalizada.
\item
  O processo de diagonalização é chamado de Decomposição em valores
  singulares. ---- 109 Decomposição em valores singulares (SVD) ---- 110
  Decomposição em valores singulares (SVD)
\item
  Teorema: qualquer matriz A pode ser decomposta em, A = UDV⊤, onde D é
  diagonal com entradas não negativas e U e V são ortogonais, i.e.~U⊤U =
  V⊤V = I.
\item
  Matrizes não quadradas não tem autovalores.
\item
  Os elementos de D são chamados de valores singulares.
\item
  Os valores singulares são os autovalores de A⊤A. ---- 111 Dimensão da
  SVD
\item
  Se A é 𝑛 × 𝑛, então U, D e V são 𝑛 × 𝑛.
\item
  Se A é 𝑛 × 𝑝, sendo 𝑛 \textgreater{} 𝑝, então U é 𝑛 × 𝑝, D e V são 𝑝 ×
  𝑝.
\item
  Se A é 𝑛 × 𝑝, sendo 𝑛 \textless{} 𝑝, então V⊤ é 𝑛 × 𝑝, D e U são 𝑛 ×
  𝑛.
\item
  D será sempre quadrada com dimensão igual ao mínimo entre 𝑝 e 𝑛. ----
  112 Decomposição em autovalores e autovetores em R
\item
  Função eigen() fornece a decomposição A \textless- matrix(c(1,0.8,
  0.3, 0.8, 1, 0.2, 0.3, 0.2, 1),3,3) isSymmetric.matrix(A) \#\# {[}1{]}
  TRUE out \textless- eigen(A) Q \textless-
  out\(vectors ## Autovetores D <- diag(out\)values) \#\# Autovalores Q
  \#\# {[},1{]} {[},2{]} {[},3{]} \#\# {[}1,{]} -0.6712373 -0.1815663
  0.71866142 \#\# {[}2,{]} -0.6507744 -0.3198152 -0.68862977 \#\#
  {[}3,{]} -0.3548708 0.9299204 -0.09651322
\item
  Verificando a solução D \#\# {[},1{]} {[},2{]} {[},3{]} \#\# {[}1,{]}
  1.934216 0.0000000 0.0000000 \#\# {[}2,{]} 0.000000 0.8726419
  0.0000000 \#\# {[}3,{]} 0.000000 0.0000000 0.1931419
  Q\%\emph{\%D\%}\%t(Q) \#\# Verificando \#\# {[},1{]} {[},2{]} {[},3{]}
  \#\# {[}1,{]} 1.0 0.8 0.3 \#\# {[}2,{]} 0.8 1.0 0.2 \#\# {[}3,{]} 0.3
  0.2 1.0 ---- 113 Decomposição em valores singulares em R
\item
  Função svd() fornece a decomposição svd(A) \#\# \$d \#\# {[}1{]}
  1.9342162 0.8726419 0.1931419 \#\# \#\# \$u \#\# {[},1{]} {[},2{]}
  {[},3{]} \#\# {[}1,{]} -0.6712373 0.1815663 0.71866142 \#\# {[}2,{]}
  -0.6507744 0.3198152 -0.68862977 \#\# {[}3,{]} -0.3548708 -0.9299204
  -0.09651322 \#\# \#\# \$v \#\# {[},1{]} {[},2{]} {[},3{]} \#\#
  {[}1,{]} -0.6712373 0.1815663 0.71866142 \#\# {[}2,{]} -0.6507744
  0.3198152 -0.68862977 \#\# {[}3,{]} -0.3548708 -0.9299204 -0.09651322
  ---- 114 Regressão ridge ---- 115 Regressão ridge
\item
  Relembrando: regressão linear múltipla ⎡ ⎢ ⎢ ⎣ 𝑦1 𝑦2 ⋮ 𝑦𝑛 ⎤ ⎥ ⎥ ⎦ 𝑛×1
  = ⎡ ⎢ ⎢ ⎣ 1 𝑥11 \ldots{} 𝑥𝑝1 1 𝑥12 \ldots{} 𝑥𝑝1 ⋮ ⋮ ⋱ ⋮ 1 𝑥1𝑛 \ldots{}
  𝑥𝑝𝑛 ⎤ ⎥ ⎥ ⎦ 𝑛×𝑝 ⎡ ⎢ ⎢ ⎣ 𝛽0 𝛽1 ⋮ 𝛽𝑝 ⎤ ⎥ ⎥ ⎦ 𝑝×1
\item
  Usando uma notação mais compacta, y 𝑛×1 = X 𝑛×𝑝 𝛽 𝑝×1 .
\item
  Minimiza a perda quadrática:̂ 𝛽 = (X⊤X)−1X⊤y. ---- 116 Regressão ridge
\item
  Se 𝑝 \textgreater{} 𝑛 o sistema é singular (múltiplas soluções)!
\item
  Como podemos ajustar o modelo?
\item
  Introduzir uma penalidade pela complexidade.
\item
  Soma de quadrados penalizada 𝑃 𝑆𝑄(𝛽) = 𝑛 ∑ 𝑖=1 (𝑦𝑖 − 𝑥⊤ 𝑖 𝛽)2 + 𝜆 𝑝 ∑
  𝑗=1 𝛽2 𝑗 .
\item
  Matricialmente, tem-se 𝑃 𝑆𝑄(𝛽) = (𝑦 − X𝛽)⊤(𝑦 − X𝛽) + 𝜆𝛽⊤𝛽.
\item
  IMPORTANTE !!
\item
  𝑦 centrado (média zero).
\item
  X padronizada por coluna (média zero e variância um). ---- 117
  Regressão ridge
\item
  Objetivo: minizar a soma de quadrados penalizada.
\item
  Derivada 𝜕𝑃 𝑄𝑆(𝛽) 𝜕𝛽 = 𝜕 𝜕𝛽 {[}(𝑦 − X𝛽)⊤(𝑦 − X𝛽) + 𝜆𝛽⊤𝛽{]} = {[} 𝜕 𝜕𝛽
  (𝑦 − X𝛽)⊤{]} (𝑦 − X𝛽) + (𝑦 − X𝛽)⊤ {[} 𝜕 𝜕𝛽 (𝑦 − X𝛽){]} + 𝜆 \{{[} 𝜕𝛽⊤
  𝜕𝛽 {]} 𝛽 + 𝛽⊤ {[} 𝜕𝛽 𝜕𝛽 {]}\} = −2X⊤(𝑦 − X𝛽) + 2𝜆𝛽 = −X⊤(𝑦 − X𝛽) + 𝜆𝛽.
  ---- 118 Aplicação: regressão ridge
\item
  Resolvendo o sistema linear, tem-se −X⊤(𝑦 − X̂𝛽) + 𝜆Î 𝛽 = 0 −X⊤𝑦 + X⊤X̂𝛽
  + 𝜆Î 𝛽 = 0 X⊤X̂𝛽 + 𝜆Î 𝛽 = X⊤𝑦 (X⊤X + 𝜆I)̂ 𝛽 = X⊤𝑦̂ 𝛽 = (X⊤X + 𝜆I)−1 X⊤𝑦.
\item
  Solução depende de 𝜆.
\item
  A inclusão de 𝜆 faz o sistema ser não singular.
\item
  Na verdade quando fixamos 𝜆 selecionamos uma solução em particular.
  ---- 119 Aplicação: regressão ridge
\item
  Calcular̂ 𝛽 envolve a inversão de uma matriz 𝑝 × 𝑝 potencialmente
  grande.̂ 𝛽 = (X⊤X + 𝜆I)−1 X⊤𝑦.
\item
  Usando a decomposição SVD, tem-se X = UDV⊤.
\item
  É possível mostrar que,̂ 𝛽 = Vdiag ( 𝑑𝑗 𝑑2 𝑗 + 𝜆 ) U⊤𝑦. ---- 120
  Implementação computacional: regressão ridge ---- 121 Implementação:
  regressão ridge
\item
  Simulando o conjunto de dados (𝑛 = 100, 𝑝 = 200). set.seed(123) X
  \textless- matrix(NA, ncol = 200, nrow = 100) X{[},1{]} \textless- 1
  \#\# Intercepto for(i in 2:200) \{ X{[},i{]} \textless- rnorm(100,
  mean = 0, sd = 1) X{[},i{]} \textless- (X{[},i{]} -
  mean(X{[},i{]}))/var(X{[},i{]}) \} \#\# Parâmetros beta \textless-
  rbinom(200, size = 1, p = 0.1)\emph{rnorm(200, mean = 10) mu
  \textless- X\%}\%beta \#\# Observações y \textless- rnorm(100, mean =
  mu, sd = 10) ---- 122 Implementando o modelo.
\item
  Modelo passo-a-passo y\_c \textless- y - mean(y) X\_svd \textless-
  svd(X) \#\# Decomposição svd lambda = 0.5 \#\# Penalização DD
  \textless- Diagonal(100, X\_svd\(d/(X_svd\)d\^{}2 + lambda)) DD{[}1{]}
  \textless- 0 \#\# Não penalizar o intercepto beta\_hat =
  as.numeric(X\_svd\(v%*%DD%*%t(X_svd
  \)u)\%*\%y\_c) ---- 123 Resultados: regressão ridge
\item
  Ajustados versus verdadeiros. plot(beta \textasciitilde{} beta\_hat,
  xlab = expression(hat(beta)), ylab = expression(beta))−4 −2 0 2 4 6 8
  0 2 4 6 8 10 12 β \^{} β ---- 124 Resultados: regressão ridge
\item
  Regressão com penalização ridge, bem como, outras penalizações são
  eficientemente implementadas em R via pacote glmnet.
\item
  IMPORTANTE! A penalização no glmnet é ligeiramente diferente, por isso
  oŝ 𝛽's não são idênticos a nossa implementação naive.
\item
  O glmnet oferece opções para selecionar 𝜆 via validação cruzada.
  require(glmnet) beta\_glm \textless- cv.glmnet(X{[},-1{]}, y\_c,
  nlambda = 100) ---- 125 Resultados: regressão ridge
\item
  Validação cruzada. plot(beta\_glm)−2 −1 0 1 2 800 1000 1200 1400 1600
  1800 Log(λ ) Mean−Squared Error 103 96 94 90 88 82 80 76 74 67 60 52
  43 38 32 27 22 15 9 3 0 ---- 126 Resultados: regressão ridge
\item
  Ajustados (glmnet) versus verdadeiros. plot(beta \textasciitilde{}
  as.numeric(coef(beta\_glm)), xlab = expression(hat(beta)), ylab =
  expression(beta))−2 0 2 4 6 8 0 2 4 6 8 10 12 β \^{} β ---- 127
  Comentários ---- 128 Comentários
\item
  Solução de sistemas lineares:
\item
  Métodos diretos: Eliminação de Gauss e Gauss-Jordan.
\item
  Métodos iterativos: Jacobi e Gauss-Seidel.
\item
  Inversa de matrizes.
\item
  Decomposição ou fatorização
\item
  LU resolve sistema lineares pode ser usada para obter inversas.
\item
  Autovalores e autovetores.
\item
  Valores singulares.
\item
  Existem muitas outras fatorizações: QR, Cholesky, Cholesky
  modificadas, etc. ---- 129
\end{itemize}

\end{document}
